MIME-Version: 1.0
Content-Type: multipart/related; boundary="----=_NextPart_01C6E0A9.E7E02880"

This document is a Single File Web Page, also known as a Web Archive file.  If you are seeing this message, your browser or editor doesn't support Web Archive files.  Please download a browser that supports Web Archive, such as Microsoft Internet Explorer.

------=_NextPart_01C6E0A9.E7E02880
Content-Location: file:///C:/EA821E05/Readme.htm
Content-Transfer-Encoding: quoted-printable
Content-Type: text/html; charset="us-ascii"

<html xmlns:o=3D"urn:schemas-microsoft-com:office:office"
xmlns:w=3D"urn:schemas-microsoft-com:office:word"
xmlns:st1=3D"urn:schemas-microsoft-com:office:smarttags"
xmlns=3D"http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=3DContent-Type content=3D"text/html; charset=3Dus-ascii">
<meta name=3DProgId content=3DWord.Document>
<meta name=3DGenerator content=3D"Microsoft Word 11">
<meta name=3DOriginator content=3D"Microsoft Word 11">
<link rel=3DFile-List href=3D"Readme_files/filelist.xml">
<title>vshadow</title>
<o:SmartTagType namespaceuri=3D"urn:schemas-microsoft-com:office:smarttags"
 name=3D"mswterms"/>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Adi Oltean</o:Author>
  <o:Template>Normal</o:Template>
  <o:LastAuthor>Dinesh Haridas</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>0</o:TotalTime>
  <o:LastPrinted>2004-06-30T23:02:00Z</o:LastPrinted>
  <o:Created>2006-09-25T20:52:00Z</o:Created>
  <o:LastSaved>2006-09-25T20:52:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>4311</o:Words>
  <o:Characters>24577</o:Characters>
  <o:Company>Microsoft Corporation</o:Company>
  <o:Lines>204</o:Lines>
  <o:Paragraphs>57</o:Paragraphs>
  <o:CharactersWithSpaces>28831</o:CharactersWithSpaces>
  <o:Version>11.6568</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:Compatibility>
   <w:BreakWrappedTables/>
   <w:SnapToGridInCell/>
   <w:WrapTextWithPunct/>
   <w:UseAsianBreakRules/>
   <w:UseWord2002TableStyleRules/>
   <w:UseFELayout/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState=3D"false" LatentStyleCount=3D"156">
 </w:LatentStyles>
</xml><![endif]--><!--[if !mso]><object
 classid=3D"clsid:38481807-CA0E-42D2-BF39-B33AF135CC4D" id=3Dieooui></objec=
t>
<style>
st1\:*{behavior:url(#ieooui) }
</style>
<![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:"MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;
	mso-font-alt:"\FF2D\FF33 \660E\671D";
	mso-font-charset:128;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:-536870145 1791491579 18 0 131231 0;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-520078593 -1073717157 41 0 66047 0;}
@font-face
	{font-family:"Lucida Console";
	panose-1:2 11 6 9 4 5 4 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:-2147482993 6144 0 0 31 0;}
@font-face
	{font-family:"\@MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;
	mso-font-charset:128;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:-536870145 1791491579 18 0 131231 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:Arial;
	mso-fareast-font-family:"MS Mincho";
	mso-bidi-font-family:"Times New Roman";
	mso-fareast-language:JA;}
h1
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:16.0pt;
	font-family:Arial;
	mso-font-kerning:16.0pt;
	mso-fareast-language:JA;}
h2
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:14.0pt;
	font-family:Arial;
	mso-fareast-language:JA;
	font-style:italic;}
h3
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:13.0pt;
	font-family:Arial;
	mso-fareast-language:JA;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{mso-style-update:auto;
	mso-style-noshow:yes;
	mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:Arial;
	mso-fareast-font-family:"MS Mincho";
	mso-bidi-font-family:"Times New Roman";
	mso-fareast-language:JA;}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{mso-style-update:auto;
	mso-style-noshow:yes;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:12.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:Arial;
	mso-fareast-font-family:"MS Mincho";
	mso-bidi-font-family:"Times New Roman";
	mso-fareast-language:JA;}
p.MsoToc3, li.MsoToc3, div.MsoToc3
	{mso-style-update:auto;
	mso-style-noshow:yes;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:24.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:Arial;
	mso-fareast-font-family:"MS Mincho";
	mso-bidi-font-family:"Times New Roman";
	mso-fareast-language:JA;}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:center 3.0in right 6.0in;
	font-size:10.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:Arial;
	mso-fareast-font-family:"MS Mincho";
	mso-bidi-font-family:"Times New Roman";
	mso-fareast-language:JA;}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:center 3.0in right 6.0in;
	font-size:10.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:Arial;
	mso-fareast-font-family:"MS Mincho";
	mso-bidi-font-family:"Times New Roman";
	mso-fareast-language:JA;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
p.MsoDocumentMap, li.MsoDocumentMap, div.MsoDocumentMap
	{mso-style-noshow:yes;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	background:navy;
	font-size:10.0pt;
	font-family:Tahoma;
	mso-fareast-font-family:"MS Mincho";
	mso-fareast-language:JA;}
p.MsoPlainText, li.MsoPlainText, div.MsoPlainText
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"MS Mincho";
	mso-fareast-language:JA;}
 /* Page Definitions */
 @page
	{mso-footnote-separator:url("Readme_files/header.htm") fs;
	mso-footnote-continuation-separator:url("Readme_files/header.htm") fcs;
	mso-endnote-separator:url("Readme_files/header.htm") es;
	mso-endnote-continuation-separator:url("Readme_files/header.htm") ecs;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 65.95pt 1.0in 65.95pt;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-header:url("Readme_files/header.htm") h1;
	mso-even-footer:url("Readme_files/header.htm") ef1;
	mso-footer:url("Readme_files/header.htm") f1;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
 @list l0
	{mso-list-id:93093319;
	mso-list-type:hybrid;
	mso-list-template-ids:-449141780 67698705 67698713 67698715 67698703 67698=
713 67698715 67698703 67698713 67698715;}
@list l0:level1
	{mso-level-text:"%1\)";
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level2
	{mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level3
	{mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1
	{mso-list-id:199511841;
	mso-list-type:hybrid;
	mso-list-template-ids:-135487060 67698705 67698713 67698715 67698703 67698=
713 67698715 67698703 67698713 67698715;}
@list l1:level1
	{mso-level-text:"%1\)";
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2
	{mso-list-id:267781350;
	mso-list-type:hybrid;
	mso-list-template-ids:-1059918930 67698705 67698713 67698715 67698703 6769=
8713 67698715 67698703 67698713 67698715;}
@list l2:level1
	{mso-level-text:"%1\)";
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level2
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level3
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:1.5in;
	mso-level-number-position:right;
	text-indent:-9.0pt;}
@list l2:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3
	{mso-list-id:297493122;
	mso-list-type:hybrid;
	mso-list-template-ids:-1614652522 67698705 67698713 67698715 67698703 6769=
8713 67698715 67698703 67698713 67698715;}
@list l3:level1
	{mso-level-text:"%1\)";
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4
	{mso-list-id:344720789;
	mso-list-type:hybrid;
	mso-list-template-ids:-1801052226 1452824072 67698691 67698693 67698689 67=
698691 67698693 67698689 67698691 67698693;}
@list l4:level1
	{mso-level-number-format:bullet;
	mso-level-text:-;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Arial;
	mso-fareast-font-family:"MS Mincho";}
@list l4:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l5
	{mso-list-id:355666411;
	mso-list-type:hybrid;
	mso-list-template-ids:1618504426 67698705 67698713 67698715 67698703 67698=
713 67698715 67698703 67698713 67698715;}
@list l5:level1
	{mso-level-text:"%1\)";
	mso-level-tab-stop:.75in;
	mso-level-number-position:left;
	margin-left:.75in;
	text-indent:-.25in;}
@list l6
	{mso-list-id:512063755;
	mso-list-type:hybrid;
	mso-list-template-ids:-635688958 67698703 67698713 67698715 67698703 67698=
713 67698715 67698703 67698713 67698715;}
@list l6:level1
	{mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;}
@list l6:level2
	{mso-level-tab-stop:.75in;
	mso-level-number-position:left;
	margin-left:.75in;
	text-indent:-.25in;}
@list l6:level3
	{mso-level-tab-stop:1.25in;
	mso-level-number-position:left;
	margin-left:1.25in;
	text-indent:-.25in;}
@list l6:level4
	{mso-level-tab-stop:1.75in;
	mso-level-number-position:left;
	margin-left:1.75in;
	text-indent:-.25in;}
@list l6:level5
	{mso-level-tab-stop:2.25in;
	mso-level-number-position:left;
	margin-left:2.25in;
	text-indent:-.25in;}
@list l6:level6
	{mso-level-tab-stop:2.75in;
	mso-level-number-position:left;
	margin-left:2.75in;
	text-indent:-.25in;}
@list l6:level7
	{mso-level-tab-stop:3.25in;
	mso-level-number-position:left;
	margin-left:3.25in;
	text-indent:-.25in;}
@list l6:level8
	{mso-level-tab-stop:3.75in;
	mso-level-number-position:left;
	margin-left:3.75in;
	text-indent:-.25in;}
@list l6:level9
	{mso-level-tab-stop:4.25in;
	mso-level-number-position:left;
	margin-left:4.25in;
	text-indent:-.25in;}
@list l7
	{mso-list-id:517550714;
	mso-list-type:hybrid;
	mso-list-template-ids:1474332014 1452824072 67698691 67698693 67698689 676=
98691 67698693 67698689 67698691 67698693;}
@list l7:level1
	{mso-level-number-format:bullet;
	mso-level-text:-;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Arial;
	mso-fareast-font-family:"MS Mincho";}
@list l7:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";}
@list l7:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Wingdings;}
@list l7:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l7:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l7:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l7:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l7:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l7:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l8
	{mso-list-id:674042777;
	mso-list-type:hybrid;
	mso-list-template-ids:1885754080 67698705 67698713 67698715 67698703 67698=
713 67698715 67698703 67698713 67698715;}
@list l8:level1
	{mso-level-text:"%1\)";
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l8:level2
	{mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l8:level3
	{mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l8:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l8:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l8:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l8:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l8:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l8:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l9
	{mso-list-id:1072315606;
	mso-list-type:hybrid;
	mso-list-template-ids:-1473190974 67698705 67698713 67698715 67698703 6769=
8713 67698715 67698703 67698713 67698715;}
@list l9:level1
	{mso-level-text:"%1\)";
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l9:level2
	{mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l9:level3
	{mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l9:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l9:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l9:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l9:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l9:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l9:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l10
	{mso-list-id:1088160823;
	mso-list-type:hybrid;
	mso-list-template-ids:207778464 67698705 67698713 67698715 67698703 676987=
13 67698715 67698703 67698713 67698715;}
@list l10:level1
	{mso-level-text:"%1\)";
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l10:level2
	{mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l10:level3
	{mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l10:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l10:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l10:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l10:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l10:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l10:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l11
	{mso-list-id:1280262915;
	mso-list-type:hybrid;
	mso-list-template-ids:258348930 67698705 67698713 67698715 67698703 676987=
13 67698715 67698703 67698713 67698715;}
@list l11:level1
	{mso-level-text:"%1\)";
	mso-level-tab-stop:.75in;
	mso-level-number-position:left;
	margin-left:.75in;
	text-indent:-.25in;}
@list l12
	{mso-list-id:1347713519;
	mso-list-type:hybrid;
	mso-list-template-ids:1112025338 67698705 67698713 67698715 67698703 67698=
713 67698715 67698703 67698713 67698715;}
@list l12:level1
	{mso-level-text:"%1\)";
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l13
	{mso-list-id:1554655703;
	mso-list-type:hybrid;
	mso-list-template-ids:-947988086 67698703 67698713 67698715 67698703 67698=
713 67698715 67698703 67698713 67698715;}
@list l13:level1
	{mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l13:level2
	{mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l13:level3
	{mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l13:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l13:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l13:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l13:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l13:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l13:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l14
	{mso-list-id:1570767336;
	mso-list-type:hybrid;
	mso-list-template-ids:-1133374322 1452824072 67698691 67698693 67698689 67=
698691 67698693 67698689 67698691 67698693;}
@list l14:level1
	{mso-level-start-at:3;
	mso-level-number-format:bullet;
	mso-level-text:-;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Arial;
	mso-fareast-font-family:"MS Mincho";}
@list l15
	{mso-list-id:1572080385;
	mso-list-type:hybrid;
	mso-list-template-ids:-1559453756 67698705 67698691 67698693 67698689 6769=
8691 67698693 67698689 67698691 67698693;}
@list l15:level1
	{mso-level-text:"%1\)";
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l16
	{mso-list-id:1720548971;
	mso-list-type:hybrid;
	mso-list-template-ids:-1456697500 67698705 67698713 67698715 67698703 6769=
8713 67698715 67698703 67698713 67698715;}
@list l16:level1
	{mso-level-text:"%1\)";
	mso-level-tab-stop:.75in;
	mso-level-number-position:left;
	margin-left:.75in;
	text-indent:-.25in;}
@list l17
	{mso-list-id:1741244755;
	mso-list-type:hybrid;
	mso-list-template-ids:-1507806864 1452824072 67698691 67698693 67698689 67=
698691 67698693 67698689 67698691 67698693;}
@list l17:level1
	{mso-level-number-format:bullet;
	mso-level-text:-;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Arial;
	mso-fareast-font-family:"MS Mincho";}
@list l18
	{mso-list-id:1842237178;
	mso-list-template-ids:852393608;}
@list l18:level1
	{mso-level-text:"%1\)";
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l18:level2
	{mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l18:level3
	{mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l18:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l18:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l18:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l18:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l18:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l18:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l19
	{mso-list-id:1971207127;
	mso-list-type:hybrid;
	mso-list-template-ids:-1093924526 67698705 67698713 67698715 67698703 6769=
8713 67698715 67698703 67698713 67698715;}
@list l19:level1
	{mso-level-text:"%1\)";
	mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;}
@list l20
	{mso-list-id:2099279917;
	mso-list-type:hybrid;
	mso-list-template-ids:-2117722178 1452824072 67698691 67698693 67698689 67=
698691 67698693 67698689 67698691 67698693;}
@list l20:level1
	{mso-level-number-format:bullet;
	mso-level-text:-;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Arial;
	mso-fareast-font-family:"MS Mincho";}
@list l20:level2
	{mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l20:level3
	{mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l20:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l20:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l20:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l20:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l20:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l20:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
table.MsoTableGrid
	{mso-style-name:"Table Grid";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	border:solid windowtext 1.0pt;
	mso-border-alt:solid windowtext .5pt;
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-border-insideh:.5pt solid windowtext;
	mso-border-insidev:.5pt solid windowtext;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
</style>
<![endif]-->
</head>

<body lang=3DEN-US link=3Dblue vlink=3Dpurple style=3D'tab-interval:.5in'>

<div class=3DSection1>

<p class=3DMsoHeader><b style=3D'mso-bidi-font-weight:normal'><span
style=3D'font-size:20.0pt'>The VSHADOW sample client<o:p></o:p></span></b><=
/p>

<p class=3DMsoPlainText align=3Dcenter style=3D'text-align:center'><span
style=3D'font-family:Arial'><o:p>&nbsp;</o:p></span></p>

<h2><a name=3D"_Toc146699228">Introduction</a></h2>

<p class=3DMsoPlainText><span style=3D'font-family:Arial'><o:p>&nbsp;</o:p>=
</span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial'>This tool serves =
as a
sample VSS application that demonstrates various tasks performed by a regul=
ar
VSS requestor. VSHADOW.EXE also offers a simple command-line interface for =
VSS
management, including shadow copy creation, deletion and query.<o:p></o:p><=
/span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial'><o:p>&nbsp;</o:p>=
</span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial'>This sample code =
must be
compiled with Visual Studio 2005.<o:p></o:p></span></p>

<h2><a name=3D"_Toc146699229">Command line options</a></h2>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal>The VSHADOW tool can be used for snapshot creation,
deletion, query and other management operations like break or expose. If an=
y of
these commands fail, VSHADOW will return the appropriate exit code. You can
detect this exit code through the ERRORLEVEL environment variable.</p>

<h3 style=3D'margin-left:.25in'><a name=3D"_Toc146699230">Shadow copy creat=
ion</a></h3>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><b style=3D'mso-bidi-font-weight:normal'><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'>Syntax:<o:p>=
</o:p></span></b></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><span
style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp; </span>VSHADOW
[optional list of flags] {list of volumes} <o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><b style=3D'mso-bidi-font-weight:normal'><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'>Flags:<o:p><=
/o:p></span></b></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><span
style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp; </span>-p
<span style=3D'mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span=
>-
Creates persistent shadow copies<o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><span
style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp; </span>-nw
<span style=3D'mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>-
Creates shadow copies without involving writers<o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><span
style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp; </span>-ad
<span style=3D'mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>-
Creates Differential Hardware shadow copies<o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><span
style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp; </span>-ap
<span style=3D'mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>-
Creates Plex Hardware shadow copies<o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><span
style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp; </span>-scsf
<span style=3D'mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>-
Creates Shadow Copies for Shared Folders (Client accessible)<o:p></o:p></sp=
an></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><span
style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp; </span>-wi=3D{writer}<span
style=3D'mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>-
Verifies that a certain writer/component is included<o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><span
style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp; </span>-wx=3D{writer}<span
style=3D'mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>-
Excludes a certain writer/component from the shadow copy<o:p></o:p></span><=
/p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><span
style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp; </span>-t=3D{file.xml}<span
style=3D'mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>-
Creates a transportable shadow copy and saves the Backup Components <o:p></=
o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:2.0in'><span style=3D'font-fam=
ily:Arial;
mso-bidi-font-family:"Courier New"'><span style=3D'mso-spacerun:yes'>&nbsp;
</span>document into the given file. This file can be used in a subsequent
Import and/or restore.<o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><span
style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp; </span>-bc=3D{file.xml}<span
style=3D'mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>-
Creates a non-transportable shadow copy and saves the Backup <o:p></o:p></s=
pan></p>

<p class=3DMsoPlainText style=3D'margin-left:1.5in;text-indent:.5in'><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'>Components
document into the given file. This file can be used in a <o:p></o:p></span>=
</p>

<p class=3DMsoPlainText style=3D'margin-left:1.5in;text-indent:.5in'><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'>subsequent
restore.<o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><span
style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp; </span>-script=3D{file.cmd}<span
style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp; </span>-
Generates a CMD file containing<span style=3D'mso-spacerun:yes'>&nbsp;
</span>environment variables related to created <o:p></o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:1.5in;text-indent:.5in'><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'><span
style=3D'mso-spacerun:yes'>&nbsp; </span>shadow copies (the shadow copy IDs=
, the
shadow copy set ID, etc)<o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><span
style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp; </span>-exec=3D{command}<span
style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =
</span>-
Executes a shell command between the shadow set creation and <o:p></o:p></s=
pan></p>

<p class=3DMsoPlainText style=3D'margin-left:1.5in;text-indent:.5in'><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'>VSHADOW prog=
ram
exit. Useful for non-persistent shadow copies.<o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><span
style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp; </span>-wait<span
style=3D'mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>-
Wait for the user interaction before exiting. This will keep alive non-<o:p=
></o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:1.5in;text-indent:.5in'><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'>persistent
shadows.<o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><span
style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp; </span>-tracing<span
style=3D'mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp; </span>-
Verbose output &#8211; useful for diagnosis.<o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><b style=3D'mso-bidi-font-weight:normal'><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'>Notes<o:p></=
o:p></span></b></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>The
specified list of volumes should use spacing characters as separators. The
volumes can optionally be terminated with a backspace, so both C: and C:\ a=
re
valid volumes. You can also specify mount points (for example c:\foo) or vo=
lume
names (like \\?\Volume{edbed95e-7e8d-11d8-9d01-505054503030}\) <o:p></o:p><=
/span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>When
the shadow copy is created with writers, VSHADOW will automatically select =
all affected
writer components by the specified volume. You can see the list of affected
volumes for each writer by using the &#8220;-wm&#8221; option (listing the
writer metadata). A writer can be specifically excluded from the shadow copy
process by using the &#8211;wx option. Also, you can verify if a writer is
included through the &#8220;-wi&#8221; option. Please see the chapter titled
&#8220;Shadow Copy management topics&#8221; for more details on shadow crea=
tion
with VSHADOW.<o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>The
shadow devices will appear in the system during creation, excepting in the
transportable shadow creation mode (the -t option). In the transportable ca=
se,
you must have a subsequent import phase on the same machine or on a differe=
nt
machine. Please see the &#8220;shadow copy import&#8221; chapter for more
details. <o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<h3 style=3D'margin-left:.25in'><a name=3D"_Toc146699231">Shadow copy impor=
t</a></h3>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><b style=3D'mso-bidi-font-weight:normal'><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'>Syntax:<o:p>=
</o:p></span></b></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><span
style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp; </span>VSHADOW
[optional list of flags] -i=3D{file.xml}<o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><b style=3D'mso-bidi-font-weight:normal'><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'>Flags:<o:p><=
/o:p></span></b></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><span
style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp; </span>-exec=3D{command}<span
style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =
</span>-
Executes a shell command between the shadow set creation and <o:p></o:p></s=
pan></p>

<p class=3DMsoPlainText style=3D'margin-left:1.5in;text-indent:.5in'><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'>VSHADOW prog=
ram
exit. Useful for non-persistent imported shadow copies.<o:p></o:p></span></=
p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><span
style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp; </span>-wait<span
style=3D'mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>-
Wait for the user interaction before exiting. This will keep alive non-<o:p=
></o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:1.5in;text-indent:.5in'><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'>persistent
shadows.<o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><span
style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp; </span>-tracing<span
style=3D'mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp; </span>-
Verbose output &#8211; useful for diagnosis.<o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><b style=3D'mso-bidi-font-weight:normal'><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'>Notes<o:p></=
o:p></span></b></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>The
{file.xml} file must be a backup components file previously created with the
&#8211;t option.<o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>Note
that when the shadow copy was originally created as non-persistent, the dev=
ice
will appear for a short time while the &#8220;VSHADOW &#8211;i=3D&#8230;&#8=
221;
command is running, and will automatically go away when the program executi=
on
ends. You can access these devices only through an optional script executed
through -exec command. <o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<h3 style=3D'margin-left:.25in'><a name=3D"_Toc146699232">Shadow copy query=
</a></h3>

<p class=3DMsoPlainText><b style=3D'mso-bidi-font-weight:normal'><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'><o:p>&nbsp;<=
/o:p></span></b></p>

<p class=3DMsoPlainText><b style=3D'mso-bidi-font-weight:normal'><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'>Syntax:<o:p>=
</o:p></span></b></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'><span style=3D'font-fami=
ly:Arial;
mso-bidi-font-family:"Courier New"'>VSHADOW { -q | -qx=3D{SnapSetID} }<o:p>=
</o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'><span style=3D'font-fami=
ly:Arial;
mso-bidi-font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><b style=3D'mso-bidi-font-weight:normal'><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'>Supported fl=
ags:<o:p></o:p></span></b></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'><span style=3D'font-fami=
ly:Arial;
mso-bidi-font-family:"Courier New"'>-q<span
style=3D'mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style=3D'mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>-
List all shadow copies in the system<o:p></o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'><span style=3D'font-fami=
ly:Arial;
mso-bidi-font-family:"Courier New"'>-qx=3D{SnapSetID}<span
style=3D'mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span style=3D'mso-tab=
-count:
1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>- List all shadow copies in =
this
set<o:p></o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'><span style=3D'font-fami=
ly:Arial;
mso-bidi-font-family:"Courier New"'>-s=3D{SnapID}<span
style=3D'mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </spa=
n><span
style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp; </span>-
List the snapshot with the given ID<o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><b style=3D'mso-bidi-font-weight:normal'><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'>Notes:<o:p><=
/o:p></span></b></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>The
implementation uses either QuerySnapshots or GetSnapshotProperties APIs to
display the properties of the given set of shadow copies. <o:p></o:p></span=
></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<h3 style=3D'margin-left:.25in'><a name=3D"_Toc146699233">Shadow copy delet=
ion</a> </h3>

<p class=3DMsoPlainText><b style=3D'mso-bidi-font-weight:normal'><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'><o:p>&nbsp;<=
/o:p></span></b></p>

<p class=3DMsoPlainText><b style=3D'mso-bidi-font-weight:normal'><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'>Syntax:<o:p>=
</o:p></span></b></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'><span style=3D'font-fami=
ly:Arial;
mso-bidi-font-family:"Courier New"'>VSHADOW { -da | -dx=3D{SnapSetID} |
-ds=3D{SnapSetID} }<o:p></o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'><span style=3D'font-fami=
ly:Arial;
mso-bidi-font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><b style=3D'mso-bidi-font-weight:normal'><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'>Supported fl=
ags:<o:p></o:p></span></b></p>

<p class=3DMsoPlainText style=3D'text-indent:.5in'><span style=3D'font-fami=
ly:Arial;
mso-bidi-font-family:"Courier New"'><span style=3D'mso-spacerun:yes'>&nbsp;
</span>-da<span
style=3D'mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style=3D'mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>-
Deletes all shadow copies in the system<o:p></o:p></span></p>

<p class=3DMsoPlainText style=3D'text-indent:.5in'><span style=3D'font-fami=
ly:Arial;
mso-bidi-font-family:"Courier New"'><span style=3D'mso-spacerun:yes'>&nbsp;
</span>-dx=3D{SnapSetID}<span style=3D'mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;=
 </span><span
style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp; </span>- Deletes all sha=
dow
copies in ths set<o:p></o:p></span></p>

<p class=3DMsoPlainText style=3D'text-indent:.5in'><span style=3D'font-fami=
ly:Arial;
mso-bidi-font-family:"Courier New"'><span style=3D'mso-spacerun:yes'>&nbsp;
</span>-ds=3D{SnapID}<span
style=3D'mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>- Del=
etes
this shadow copy<o:p></o:p></span></p>

<p class=3DMsoNormal><span style=3D'font-family:"Times New Roman"'><o:p>&nb=
sp;</o:p></span></p>

<p class=3DMsoNormal><b style=3D'mso-bidi-font-weight:normal'><span
style=3D'mso-bidi-font-family:Arial'>Notes: <o:p></o:p></span></b></p>

<p class=3DMsoNormal><span style=3D'mso-bidi-font-family:Arial'><o:p>&nbsp;=
</o:p></span></p>

<p class=3DMsoNormal><span style=3D'mso-bidi-font-family:Arial'>The &#8211;=
da
option requires user confirmation.<o:p></o:p></span></p>

<p class=3DMsoNormal><span style=3D'mso-bidi-font-family:Arial'><o:p>&nbsp;=
</o:p></span></p>

<p class=3DMsoNormal><span style=3D'mso-bidi-font-family:Arial'>Non-persist=
ent
shadow copies will be automatically deleted when the VSHADOW creation/import
process exits (except if Break was called on the shadow set prior to exit).=
 <o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'text-indent:.25in'><span style=3D'mso-bidi-fo=
nt-family:
Arial'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoNormal style=3D'text-indent:.25in'><span style=3D'mso-bidi-fo=
nt-family:
Arial'><o:p>&nbsp;</o:p></span></p>

<h3 style=3D'margin-left:.25in'><a name=3D"_Toc146699234">Breaking a shadow=
 copy
set</a></h3>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>This
command is useful to convert the shadow volumes into standalone read-only/r=
ead-write
volumes. Note that after this operation the shadow set is gone from VSS poi=
nt
of view and cannot be used for further management operations like query, ex=
pose
or delete. <o:p></o:p></span></p>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoPlainText><b style=3D'mso-bidi-font-weight:normal'><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'>Syntax:<o:p>=
</o:p></span></b></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'><span style=3D'font-fami=
ly:Arial;
mso-bidi-font-family:"Courier New"'>VSHADOW { -b=3D{SnapSetID} | -bw=3D{Sna=
pSetID}
}<o:p></o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'><span style=3D'font-fami=
ly:Arial;
mso-bidi-font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><b style=3D'mso-bidi-font-weight:normal'><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'>Supported fl=
ags:<o:p></o:p></span></b></p>

<p class=3DMsoNormal style=3D'text-indent:.25in'><span style=3D'mso-bidi-fo=
nt-size:
10.0pt;mso-bidi-font-family:"Courier New"'>-b=3D{SnapSetID}<span
style=3D'mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style=3D'mso-tab-count:1'>&nbsp; </span>- Break the given shadow copy set i=
nto
standalone read-only volumes.<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'text-indent:.25in'><span style=3D'mso-bidi-fo=
nt-size:
10.0pt;mso-bidi-font-family:"Courier New"'>-bw=3D{SnapSetID}<span
style=3D'mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span style=3D'mso-tab=
-count:
1'> </span>- Break the shadow copy set into standalone writable volumes<o:p=
></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><b style=3D'mso-bidi-font-weight:normal'><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'>Notes: <o:p>=
</o:p></span></b></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>Non-persistent
shadow copies can be accessed only though the &#8211;exec scripts. To prese=
rve
the device beyond the program VSHADOW execution you must break the
non-persistent shadow in a special script through the &#8211;exec command. =
<o:p></o:p></span></p>

<h3 style=3D'margin-left:.25in'><a name=3D"_Toc146699235">Exposing a shadow=
 copy
locally</a></h3>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>This
command is used to assign a drive letter or a mount point to a persistent s=
hadow
copy. Note that the volume will be still read-only unless you use a subsequ=
ent VSHADOW
-bw to convert this shadow copy into a standalone volume. <o:p></o:p></span=
></p>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal>Non-persistent shadow copies or client accessible shad=
ow
copies cannot be exposed locally.</p>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoPlainText><b style=3D'mso-bidi-font-weight:normal'><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'>Syntax:<o:p>=
</o:p></span></b></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'><span style=3D'font-fami=
ly:Arial;
mso-bidi-font-family:"Courier New"'>VSHADOW -el=3D{SnapID},LocalEmptyDirect=
ory<o:p></o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'><span style=3D'font-fami=
ly:Arial;
mso-bidi-font-family:"Courier New"'>VSHADOW -el=3D{SnapID},UnusedDriveLette=
r<o:p></o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'><span style=3D'font-fami=
ly:Arial;
mso-bidi-font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'><span style=3D'font-fami=
ly:Arial;
mso-bidi-font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><b style=3D'mso-bidi-font-weight:normal'><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'>Example:<o:p=
></o:p></span></b></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>Let&#8217;s
assume that {8e8c4b6a-03b2-481c-94ac-6eb6c9bcdc1c} is the ID of an existing=
 persistent
shadow copy, and that X: is an unused drive letter. The following command w=
ill
expose the shadow copy under X:<o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><span
style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp; </span>VSHADOW
-el=3D{8e8c4b6a-03b2-481c-94ac-6eb6c9bcdc1c},x:<o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>Alternatively,
the following commands can be used to expose the persistent shadow copy und=
er
the mount point c:\ShadowCopies\Jun23:<o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><span
style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp; </span>MKDIR
c:\ShadowCopies\Jun23<o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><span
style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp; </span>VSHADOW
-el=3D{8e8c4b6a-03b2-481c-94ac-6eb6c9bcdc1c}, c:\ShadowCopies\Jun23<o:p></o=
:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<h3 style=3D'margin-left:.25in'><a name=3D"_Toc146699236">Exposing a shadow=
 copy
remotely</a></h3>

<p class=3DMsoPlainText><br>
<span style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'>This c=
ommand
is used to assign a read-only share name to the root directory (or a
subdirectory) from the shadow copy. Note that the share contents will remain
read-only unless you use a subsequent VSHADOW -bw to convert this shadow co=
py
into a standalone volume, and you change the security access to the share
object. <o:p></o:p></span></p>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal>Client accessible shadow copies cannot be exposed remo=
tely.</p>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoPlainText><b style=3D'mso-bidi-font-weight:normal'><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'>Syntax:<o:p>=
</o:p></span></b></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'><span style=3D'font-fami=
ly:Arial;
mso-bidi-font-family:"Courier New"'>VSHADOW -er=3D{SnapID},UnusedShareName<=
o:p></o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'><span style=3D'font-fami=
ly:Arial;
mso-bidi-font-family:"Courier New"'>VSHADOW -er=3D{SnapID}, UnusedShareName=
,PathFromRootOnShadow<o:p></o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'><span style=3D'font-fami=
ly:Arial;
mso-bidi-font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><b style=3D'mso-bidi-font-weight:normal'><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'>Example:<o:p=
></o:p></span></b></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>Let&#8217;s
assume that {8e8c4b6a-03b2-481c-94ac-6eb6c9bcdc1c} is the ID of an existing
shadow copy, and that share_123 is an unused share name. The following comm=
and
will expose the shadow copy under this share:<o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><span
style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp; </span>VSHADOW
-er=3D{8e8c4b6a-03b2-481c-94ac-6eb6c9bcdc1c},share_123<o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>Alternatively,
we can expose only a certain sub-tree of the shadow copy. Let&#8217;s assume
that the shadow copy contains a directory \Folder1. The, you can expose the
shadow copy image of the sub-tree under \Folder1\Folder2 like this:<o:p></o=
:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><span
style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp; </span>VSHADOW
-er=3D{8e8c4b6a-03b2-481c-94ac-6eb6c9bcdc1c},share_123,Folder1\Folder2<o:p>=
</o:p></span></p>

<p class=3DMsoNormal><span style=3D'font-family:"Times New Roman"'><o:p>&nb=
sp;</o:p></span></p>

<h3 style=3D'margin-left:.25in'><a name=3D"_Toc146699237">Listing writers a=
nd their
status/metadata</a><span style=3D'mso-bookmark:_Toc146699237'></span><span
style=3D'font-size:10.0pt;mso-bidi-font-size:13.0pt'><o:p></o:p></span></h3>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal>These commands are useful to detect potential failed
writers, and to enumerate their components.</p>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoPlainText><b style=3D'mso-bidi-font-weight:normal'><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'>Syntax:<o:p>=
</o:p></span></b></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'><span style=3D'font-fami=
ly:Arial;
mso-bidi-font-family:"Courier New"'>VSHADOW -ws<o:p></o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'><span style=3D'font-fami=
ly:Arial;
mso-bidi-font-family:"Courier New"'>VSHADOW -wm<o:p></o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'><span style=3D'font-fami=
ly:Arial;
mso-bidi-font-family:"Courier New"'>VSHADOW -wm2<o:p></o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'><span style=3D'font-fami=
ly:Arial;
mso-bidi-font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><b style=3D'mso-bidi-font-weight:normal'><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'>Notes: <o:p>=
</o:p></span></b></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>The
-ws command is the equivalent of VSSADMIN LIST WRITERS. The -wm command will
list a summary of the writer metadata (including the affected volumes). The
-wm2 command will list the full writer metadata. You can use this informati=
on
to determine what volumes to include in the snapshot set. <o:p></o:p></span=
></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial'><o:p>&nbsp;</o:p>=
</span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial'>Note that as long=
 as the
writer is in a STABLE state or WAITING_FOR_COMPLETION, the writer can be
considered in a stable state, ready for the next backup.<o:p></o:p></span><=
/p>

<h3 style=3D'margin-left:.25in'><a name=3D"_Toc146699238">Writer restore</a=
></h3>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><b style=3D'mso-bidi-font-weight:normal'><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'>Syntax:<o:p>=
</o:p></span></b></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><span
style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp; </span>VSHADOW
[optional list of flags] -r=3D{file.xml}<o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><span
style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp; </span>VSHADOW
[optional list of flags] -rs=3D{file.xml}<o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><b style=3D'mso-bidi-font-weight:normal'><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'>Flags:<o:p><=
/o:p></span></b></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><span
style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp; </span>-wi=3D{writer}<span
style=3D'mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>-
Verifies that a certain writer/component is included in restore<o:p></o:p><=
/span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><span
style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp; </span>-wx=3D{writer}<span
style=3D'mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>-
Excludes a certain writer/component from the restore<o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><span
style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp; </span>-exec=3D{command}<span
style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =
</span>-
Executes a file restore command between the Pre-restore and Post-<o:p></o:p=
></span></p>

<p class=3DMsoPlainText style=3D'margin-left:1.5in;text-indent:.5in'><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'>restore even=
ts
that were sent to the writers.<o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><span
style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp; </span>-tracing<span
style=3D'mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp; </span>-
Verbose output &#8211; useful for diagnosis.<o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><b style=3D'mso-bidi-font-weight:normal'><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'>Notes<o:p></=
o:p></span></b></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>The
{file.xml} file must be a backup components file previously created during a
shadow copy creation with either the &#8211;t or &#8211;bc options. <o:p></=
o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>A
writer can be specifically excluded from the restore process by using the
&#8211;wx option (like in the case of shadow set creation). Also, you can
verify if a writer is included through the &#8220;-wi&#8221; option. <o:p><=
/o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>The
restore process has four main parts: <o:p></o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in;text-indent:-.25in;mso-li=
st:l15 level1 lfo28;
tab-stops:list .5in'><![if !supportLists]><span style=3D'font-family:Arial;
mso-fareast-font-family:Arial'><span style=3D'mso-list:Ignore'>1)<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
 </span></span></span><![endif]><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'>Select the
components that are present in the backup components document.<o:p></o:p></=
span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in;text-indent:-.25in;mso-li=
st:l15 level1 lfo28;
tab-stops:list .5in'><![if !supportLists]><span style=3D'font-family:Arial;
mso-fareast-font-family:Arial'><span style=3D'mso-list:Ignore'>2)<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
 </span></span></span><![endif]><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'>Notify the a=
ffected
writers that a restore is about to begin (the Pre-restore event)<o:p></o:p>=
</span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in;text-indent:-.25in;mso-li=
st:l15 level1 lfo28;
tab-stops:list .5in'><![if !supportLists]><span style=3D'font-family:Arial;
mso-fareast-font-family:Arial'><span style=3D'mso-list:Ignore'>3)<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
 </span></span></span><![endif]><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'>Performing t=
he
actual restore of the writer files. This must be done through the custom co=
mmand
specified in the &#8211;exec option.<o:p></o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in;text-indent:-.25in;mso-li=
st:l15 level1 lfo28;
tab-stops:list .5in'><![if !supportLists]><span style=3D'font-family:Arial;
mso-fareast-font-family:Arial'><span style=3D'mso-list:Ignore'>4)<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
 </span></span></span><![endif]><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'>Notify the
affected writers that a restore has just happened (the Post-restore event)<=
o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>You
can also perform a simulated restore through the &#8220;-rs&#8221; option. A
simulated restore performs only the first step above and does not affect
writers nor does replace any data. This option might be very useful to
&#8220;preview&#8221; the list of components that will be restored by a
subsequent restore. <o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>There
are various approaches to perform the actual restore. Some examples are giv=
en
below:<o:p></o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in;text-indent:-.25in;mso-li=
st:l1 level1 lfo27;
tab-stops:list .5in'><![if !supportLists]><span style=3D'font-family:Arial;
mso-fareast-font-family:Arial'><span style=3D'mso-list:Ignore'>1)<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
 </span></span></span><![endif]><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'>The most dir=
ect
solution would be to manually stop/offline the writer processes through the
restore script, and copy the files to their original location.<o:p></o:p></=
span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in;text-indent:-.25in;mso-li=
st:l1 level1 lfo27;
tab-stops:list .5in'><![if !supportLists]><span style=3D'font-family:Arial;
mso-fareast-font-family:Arial'><span style=3D'mso-list:Ignore'>2)<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
 </span></span></span><![endif]><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'>A more advan=
ced
solution for quick restore uses a transportable Import process, performed
through the &#8211;exec script. In this script you can call another instanc=
e of
vshadow that performs the Import. <o:p></o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in;text-indent:-.25in;mso-li=
st:l1 level1 lfo27;
tab-stops:list .5in'><![if !supportLists]><span style=3D'font-family:Arial;
mso-fareast-font-family:Arial'><span style=3D'mso-list:Ignore'>3)<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
 </span></span></span><![endif]><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'>An alternati=
ve solution
will dismount and mask the original volumes affected by the restore, and
replacing them with a corresponding set of previously-imported volumes.<o:p=
></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>Note
that VSHADOW.EXE implements only minimal restore functionality, and does not
implement some advanced features that are required for a true requestor. Pl=
ease
consult the VSS documentation for more details on the restore process.<o:p>=
</o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>Designing
a restore procedure with VSHADOW requires manual inspection the writer rest=
ore
options through the &#8220;VSHADOW &#8211;wm&#8221; option. <o:p></o:p></sp=
an></p>

<h3 style=3D'margin-left:.25in'><a name=3D"_Toc146699239">Other command-lin=
e flags</a><span
style=3D'mso-bookmark:_Toc146699239'></span><span style=3D'font-size:10.0pt;
mso-bidi-font-size:13.0pt'><o:p></o:p></span></h3>

<p class=3DMsoPlainText><span style=3D'font-family:Arial'><o:p>&nbsp;</o:p>=
</span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in;text-indent:-.25in;mso-li=
st:l7 level1 lfo4;
tab-stops:list .5in'><![if !supportLists]><span style=3D'font-family:Arial;
mso-fareast-font-family:Arial'><span style=3D'mso-list:Ignore'>-<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style=3D'font-family:Arial'>The
&#8220;-tracing&#8221; flag will show a verbose output, including the call
execution order. This might be useful to diagnose the source code. <o:p></o=
:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in;text-indent:-.25in;mso-li=
st:l7 level1 lfo4;
tab-stops:list .5in'><![if !supportLists]><span style=3D'font-family:Arial;
mso-fareast-font-family:Arial'><span style=3D'mso-list:Ignore'>-<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style=3D'font-family:Arial'>The
&#8220;-wait&#8221; flag will stop VSHADOW at the end and ask the user to p=
ress
ENTER to continue. This is useful when you create/import a non-persistent
shadow copy since the shadow copy will be deleted right after the program
exits. So this flag will allow you to see the created shadow copy. <o:p></o=
:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial'><o:p>&nbsp;</o:p>=
</span></p>

<h2><a name=3D"_Toc146699240">Shadow copy management topics</a></h2>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<h3 style=3D'margin-left:.25in'><a name=3D"_Toc146699241">How to access sha=
dow copy
properties from a CMD script</a></h3>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>If
you use the &#8220;-script&#8221; option during shadow creation, VSHADOW can
optionally create a CMD script containing environment variables representin=
g various
useful properties of the created shadow copy/set: <o:p></o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in;text-indent:-.25in;mso-li=
st:l7 level1 lfo4;
tab-stops:list .5in'><![if !supportLists]><span style=3D'font-family:Arial;
mso-fareast-font-family:Arial'><span style=3D'mso-list:Ignore'>-<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style=3D'font-family:Arial;mso-bidi-fo=
nt-family:
"Courier New"'>The shadow set ID: the %VSHADOW_SET_ID% environment variable=
<o:p></o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in;text-indent:-.25in;mso-li=
st:l7 level1 lfo4;
tab-stops:list .5in'><![if !supportLists]><span style=3D'font-family:Arial;
mso-fareast-font-family:Arial'><span style=3D'mso-list:Ignore'>-<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style=3D'font-family:Arial;mso-bidi-fo=
nt-family:
"Courier New"'>The shadow copy ID: the %VSHADOW_ID_<i style=3D'mso-bidi-fon=
t-style:
normal'>NNN</i>% variable where NNN represents the index of the source volu=
me
in the command-line)<o:p></o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in;text-indent:-.25in;mso-li=
st:l7 level1 lfo4;
tab-stops:list .5in'><![if !supportLists]><span style=3D'font-family:Arial;
mso-fareast-font-family:Arial'><span style=3D'mso-list:Ignore'>-<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style=3D'font-family:Arial;mso-bidi-fo=
nt-family:
"Courier New"'>The shadow copy device: the %VSHADOW_DEVICE_<i style=3D'mso-=
bidi-font-style:
normal'>NNN</i>% variable where NNN represents the index of the source volu=
me
in the command-line. <o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>You
can use this generated script to perform controlled management on the creat=
ed
shadow copies. For example, you can expose a created shadow copy in this wa=
y: <o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'>VSHADOW -p -nw
-script=3DSETVAR1.cmd c:</p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'>call SETVAR1.cmd</p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'>VSHADOW -el=3D%VSHADOW_I=
D_1%,c:\directory1</p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<h3 style=3D'margin-left:.25in'><a name=3D"_Toc146699242">How to access
non-persistent shadow copies</a> </h3>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>Any
non-persistent shadow copies will be automatically deleted when the program
that creates them (VSHADOW.EXE) exits. To access the contents of these shad=
ow
copies, VSHADOW offers the ability to execute a script after the shadow
creation but before program exit. To run a script called &#8220;enum.cmd&#8=
221;
you must use the -exec command-line option:<o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>VSHADOW
-nw -exec=3Denum.cmd C:<o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>In
the executed script you can also run the generated SETVAR script in this cu=
stom
command. This allows the script to access the shadow contents directly.
Remember that the shadow device can be retrieved from the VSHADOW_DEVICE_NNN
environment variable. Here is an example: <o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'><span style=3D'font-fami=
ly:Arial;
mso-bidi-font-family:"Courier New"'>--- enum.cmd ---<o:p></o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'><span style=3D'font-fami=
ly:"Lucida Console"'>call
SETVAR1.cmd<o:p></o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'><span style=3D'font-fami=
ly:"Lucida Console"'>for
/R %VSHADOW_DEVICE_1%\ %%i in (*.*) do @echo %%i<o:p></o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'><span style=3D'font-fami=
ly:Arial;
mso-bidi-font-family:"Courier New"'>----------------------<o:p></o:p></span=
></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'><span style=3D'font-fami=
ly:Arial;
mso-bidi-font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'><span style=3D'font-fami=
ly:"Lucida Console"'>shadow
-nw -exec=3Dc:\enum.cmd -script=3Dsetvar1.cmd c:<o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>Note
that shadow copies have a special volume device syntax that is not compatib=
le
with certain shell commands - something like \\?\GLOBALROOT\Device\Harddisk=
VolumeShadowCopyXXX
or \\?\GLOBALROOT\Device\HarddiskVolumeXXX. Still, many Win32 applications =
or
shell commands can operate on this device. Some examples:<o:p></o:p></span>=
</p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in;text-indent:-.25in;mso-li=
st:l3 level1 lfo19;
tab-stops:list .5in'><![if !supportLists]><span style=3D'font-family:Arial;
mso-fareast-font-family:Arial'><span style=3D'mso-list:Ignore'>1)<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
 </span></span></span><![endif]><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'>Copying a fi=
le
from a shadow copy:<o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'><span style=3D'font-fami=
ly:"Lucida Console"'>dir
&gt; c:\somefile.txt<o:p></o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'><span style=3D'font-fami=
ly:"Lucida Console"'>VSHADOW
-p -nw -script=3DSETVAR1.cmd c:<o:p></o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'><span style=3D'font-fami=
ly:"Lucida Console"'>call
SETVAR1.cmd<o:p></o:p></span></p>

<p class=3DMsoPlainText style=3D'text-indent:.5in'><span style=3D'font-fami=
ly:"Lucida Console"'>copy
%VSHADOW_DEVICE_1%\somefile.txt c:\somefile_bak.txt<o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in;text-indent:-.25in;mso-li=
st:l3 level1 lfo19;
tab-stops:list .5in'><![if !supportLists]><span style=3D'font-family:Arial;
mso-fareast-font-family:Arial'><span style=3D'mso-list:Ignore'>2)<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
 </span></span></span><![endif]><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'>Enumerating =
all
files on a shadow copy device (from a batch file):<o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'><span style=3D'font-fami=
ly:"Lucida Console"'>dir
&gt; c:\somefile.txt<o:p></o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'><span style=3D'font-fami=
ly:"Lucida Console"'>VSHADOW
-p -nw -script=3DSETVAR1.cmd c:<o:p></o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'><span style=3D'font-fami=
ly:"Lucida Console"'>call
SETVAR1.cmd<o:p></o:p></span></p>

<p class=3DMsoPlainText style=3D'text-indent:.5in'><span style=3D'font-fami=
ly:"Lucida Console"'>for
/R %VSHADOW_DEVICE_1%\ %%i in (*) do @echo %%i<o:p></o:p></span></p>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal>Remember that in a batch file you must use the %%i syn=
tax
for FOR variables. In a CMD window, use the %i syntax instead. </p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><b style=3D'mso-bidi-font-weight:normal'><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'>Implementati=
on notes:</span></b><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'> <o:p></o:p>=
</span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in;text-indent:-.25in;mso-li=
st:l7 level1 lfo4;
tab-stops:list .5in'><![if !supportLists]><span style=3D'font-family:Arial;
mso-fareast-font-family:Arial'><span style=3D'mso-list:Ignore'>-<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style=3D'font-family:Arial;mso-bidi-fo=
nt-family:
"Courier New"'>For security reasons and to keep the implementation simple, =
the
&#8211;exec will <b style=3D'mso-bidi-font-weight:normal'>not</b> accepts
parameters to be passed to the custom command. The whole string passed to t=
he
&#8211;exec command is treated as a single CMD/EXE file. See the sources for
more comments on this limitation.<o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in;text-indent:-.25in;mso-li=
st:l7 level1 lfo4;
tab-stops:list .5in'><![if !supportLists]><span style=3D'font-family:Arial;
mso-fareast-font-family:Arial'><span style=3D'mso-list:Ignore'>-<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style=3D'font-family:Arial;mso-bidi-fo=
nt-family:
"Courier New"'>Note that the BackupComplete writer event is sent after the
&#8220;-exec&#8221; script/command is executed. The BackupComplete sent to =
the
writers signals that the backup is completed, and the writer can potentially
truncate logs at this point. Therefore it is important to verify that the s=
hadow/backup
actually completed, and if the backup failed then you can abort the creation
process by returning a non-zero exit code in the executed script/command (s=
ee
the EXIT command for more details). If the custom command returns with a
non-zero exit code, then the shadow copy creation is aborted and BackupComp=
lete
won&#8217;t be called.<o:p></o:p></span></p>

<p class=3DMsoPlainText><b style=3D'mso-bidi-font-weight:normal'><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'><o:p>&nbsp;<=
/o:p></span></b></p>

<h3 style=3D'margin-left:.25in'><a name=3D"_Toc146699243">How to manage
transportable shadow copies</a></h3>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>First,
you need two separate machines running Longhorn Server. Both machines must =
be
connected (through a SAN configuration) to a storage array that supports VSS
hardware shadow copies. Then, on each machine, a VSS hardware provider must=
 be
installed. Some VSS HW providers require a manual setup process such that
transportable shadow copies can be created on the first machine and importe=
d on
the second machine. The VSS SDK provides a software-simulated hardware prov=
ider
(vsssampleprovider) that can be used for simulating hardware shadow copies.=
 For
more information on VSS Hardware shadow copy technology please see the VSS
documentation.<o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>The
import process is given below:<o:p></o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in;text-indent:-.25in;mso-li=
st:l4 level1 lfo22;
tab-stops:list .5in'><![if !supportLists]><span style=3D'font-family:Arial;
mso-fareast-font-family:Arial'><span style=3D'mso-list:Ignore'>-<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style=3D'font-family:Arial;mso-bidi-fo=
nt-family:
"Courier New"'>Create the shadow copy set on machine A (the production serv=
er).
This will not expose any shadow copy devices on this machine. <o:p></o:p></=
span></p>

<p class=3DMsoPlainText style=3D'margin-left:1.5in;text-indent:-.25in;mso-l=
ist:
l4 level3 lfo22;tab-stops:list 1.5in'><![if !supportLists]><span
style=3D'font-family:Wingdings;mso-fareast-font-family:Wingdings;mso-bidi-f=
ont-family:
Wingdings'><span style=3D'mso-list:Ignore'>&sect;<span style=3D'font:7.0pt =
"Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>VSHADOW -p -t=3Dbc1.xml</p>

<p class=3DMsoPlainText style=3D'margin-left:.5in;text-indent:-.25in;mso-li=
st:l4 level1 lfo22;
tab-stops:list .5in'><![if !supportLists]><span style=3D'font-family:Arial;
mso-fareast-font-family:Arial'><span style=3D'mso-list:Ignore'>-<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style=3D'font-family:Arial;mso-bidi-fo=
nt-family:
"Courier New"'>Copy the backup components document on machine B<o:p></o:p><=
/span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in;text-indent:-.25in;mso-li=
st:l4 level1 lfo22;
tab-stops:list .5in'><![if !supportLists]><span style=3D'font-family:Arial;
mso-fareast-font-family:Arial'><span style=3D'mso-list:Ignore'>-<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style=3D'font-family:Arial;mso-bidi-fo=
nt-family:
"Courier New"'>Import the shadow set on machine B. This will surface the
created devices on this machine<o:p></o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:1.5in;text-indent:-.25in;mso-l=
ist:
l4 level3 lfo22;tab-stops:list 1.5in'><![if !supportLists]><span
style=3D'font-family:Wingdings;mso-fareast-font-family:Wingdings;mso-bidi-f=
ont-family:
Wingdings'><span style=3D'mso-list:Ignore'>&sect;<span style=3D'font:7.0pt =
"Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>VSHADOW -i=3Dbc1.xml</p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>Optionally,
you could expose these shadow copies as drive letters or mount points. Also,
you could potentially break the shadow set to make the new shadow copy volu=
mes
read-write. <o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>To
automate the shadow set management process you might use the -script option=
 to
generate the CMD script containing the shadow copy IDs. Then, you can copy =
the
generated script along with the backup components on the other machine.<o:p=
></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>As
an example we present below a scriptable shadow creation, expose and break
involving transportable shadow copies:<o:p></o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.75in;text-indent:-.25in;mso-l=
ist:
l8 level1 lfo10;tab-stops:list .75in'><![if !supportLists]><span
style=3D'font-family:Arial;mso-fareast-font-family:Arial'><span style=3D'ms=
o-list:
Ignore'>1)<span style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style=3D'font-family:Arial;mso-bidi-fo=
nt-family:
"Courier New"'>Create the shadow copy set on machine A (the production serv=
er).
This will not expose any shadow copy devices on this machine. Specify also =
the
&#8220;-script&#8221; option to generate the script containing the proper
environment variable definitions. <o:p></o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.75in;text-indent:.5in'>VSHADO=
W -p
-t=3Dbc1.xml -script=3Dsc1.cmd </p>

<p class=3DMsoPlainText style=3D'margin-left:.75in;text-indent:-.25in;mso-l=
ist:
l8 level1 lfo10;tab-stops:list .75in'><![if !supportLists]><span
style=3D'font-family:Arial;mso-fareast-font-family:Arial'><span style=3D'ms=
o-list:
Ignore'>2)<span style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style=3D'font-family:Arial;mso-bidi-fo=
nt-family:
"Courier New"'>Copy the backup components document and the generated script=
 on
machine B<o:p></o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.75in;text-indent:-.25in;mso-l=
ist:
l8 level1 lfo10;tab-stops:list .75in'><![if !supportLists]><span
style=3D'font-family:Arial;mso-fareast-font-family:Arial'><span style=3D'ms=
o-list:
Ignore'>3)<span style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style=3D'font-family:Arial;mso-bidi-fo=
nt-family:
"Courier New"'>Import the shadow set on machine B. This will surface the
created devices on this machine<o:p></o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.75in;text-indent:.5in'>VSHADOW
-i=3Dbc1.xml</p>

<p class=3DMsoPlainText style=3D'margin-left:.75in;text-indent:-.25in;mso-l=
ist:
l8 level1 lfo10;tab-stops:list .75in'><![if !supportLists]><span
style=3D'font-family:Arial;mso-fareast-font-family:Arial'><span style=3D'ms=
o-list:
Ignore'>4)<span style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style=3D'font-family:Arial;mso-bidi-fo=
nt-family:
"Courier New"'>Now, run the generated script to get the proper environment
variables set up. The shadow set ID goes into the variable named VSHADOW_SE=
T_ID.
The shadow ID for the first volume specified during creation goes into the =
VSHADOW_ID_1
variable, and so on.<o:p></o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.75in;text-indent:.5in'>Sc1.cm=
d</p>

<p class=3DMsoPlainText style=3D'margin-left:.75in;text-indent:-.25in;mso-l=
ist:
l8 level1 lfo10;tab-stops:list .75in'><![if !supportLists]><span
style=3D'font-family:Arial;mso-fareast-font-family:Arial'><span style=3D'ms=
o-list:
Ignore'>5)<span style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style=3D'font-family:Arial;mso-bidi-fo=
nt-family:
"Courier New"'>Expose the shadow copies to certain drive letters on machine=
 B.
This will surface the created shadow copy devices on this machine. <o:p></o=
:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.75in;text-indent:.5in'>RD /s/q
c:\mount_point</p>

<p class=3DMsoPlainText style=3D'margin-left:.75in;text-indent:.5in'>MD c:\=
mount_point</p>

<p class=3DMsoPlainText style=3D'margin-left:.75in;text-indent:.5in'>VSHADOW
&#8211;el=3D%VSHADOW_ID_1%,c:\mount_point</p>

<p class=3DMsoPlainText style=3D'margin-left:.75in;text-indent:-.25in;mso-l=
ist:
l8 level1 lfo10;tab-stops:list .75in'><![if !supportLists]><span
style=3D'font-family:Arial;mso-fareast-font-family:Arial'><span style=3D'ms=
o-list:
Ignore'>6)<span style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style=3D'font-family:Arial;mso-bidi-fo=
nt-family:
"Courier New"'>Finally, break the shadow set to make the volumes writable. =
<o:p></o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.75in;text-indent:.5in'>VSHADOW
&#8211;bw=3D%VSHADOW_SET_ID%</p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>One
final note: non-persistent shadow copies can still be imported, but they wi=
ll
go away as soon as the &#8220;VSHADOW -i&quot; process exits. To use these
devices you must execute a script during import (through the &#8211;exec
command) that would eventually expose the devices locally and then break the
set. <o:p></o:p></span></p>

<h2><a name=3D"_Toc146699244">Writer and component related topics</a></h2>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>VSHADOW
allows certain writers in the system to participate in the shadow copy crea=
tion
or restore process. For more details on writers and writer components please
see the VSS online documentation.<o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>By
default, all writers will participate in shadow copy creation unless the op=
tion
&#8220;-nw&#8221; is used. Also, you can use the &#8220;-wx&#8221; option to
selectively exclude certain writers from the creation or restore process. <=
o:p></o:p></span></p>

<h3><a name=3D"_Toc146699245">Selecting volumes for shadow copy creation</a=
></h3>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><span
style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp; </span><o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>Before
the shadow copy creation, you might run a VSHADOW -wm or even VSHADOW -wm2
command to discover the affected paths and volumes for each component. Then,
you should include enough volumes in the shadow set such that the interesti=
ng
writers\components are being involved.<o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>Remember
that if you do not include the relevant volumes, the shadow copy will not
contain the specified writers. <o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>You
can use the &#8220;-wi&#8221; option to verify that a certain writer/compon=
ent
gets included. See below for more details. <o:p></o:p></span></p>

<p class=3DMsoPlainText><o:p>&nbsp;</o:p></p>

<h3><a name=3D"_Toc146699246">Verification of writer/component inclusion</a=
></h3>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><span
style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp; </span><o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>During
creation, you can test whether certain writers or components were included =
in
the backup components through the &#8220;-wi&#8221; option. This option has=
 a
similar syntax with the &#8220;-wx&#8221; option. Similarly, you can use the
same option to verify if certain components are restored.<o:p></o:p></span>=
</p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><b style=3D'mso-bidi-font-weight:normal'><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'>Important no=
te:</span></b><span
style=3D'font-family:Arial;mso-bidi-font-family:"Courier New"'> The
&#8220;-wi&#8221; command does not actually enforce the inclusion of the
component &#8211; it just verifies that the component/writer is already
included automatically by specifying the correct volumes in the shadow copy
set. Ultimately, you must specify the correct volumes such that the desired
components will get included. Please see the chapter titled &#8220;Component
Selection in VSHADOW&#8221; for more details on the component selection
algorithm. <o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>This
option has two operational modes. First, with the &#8220;-wi&#8221; option,=
 you
can verify whether a certain component is included in the backup. There are
various syntax options here. Some examples:<o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText style=3D'text-indent:.5in'>VSHADOW
&#8211;wi=3DWriterName:\LogicalPath\ComponentName<span style=3D'mso-tab-cou=
nt:1'>&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style=3D'mso-spacerun:yes'>&nbsp;&nbsp; </span>{creation options}</p>

<p class=3DMsoPlainText style=3D'text-indent:.5in'>VSHADOW &#8211;wi=3D&quo=
t;Writer
name:\LogicalPath\ComponentName&quot; {creation options}</p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'>VSHADOW &#8211;wi=3D{Wri=
terID}:\LogicalPath\ComponentName<span
style=3D'mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>{creation options}</p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'>VSHADOW
&#8211;wi=3D{InstanceID}:\LogicalPath\ComponentName<span
style=3D'mso-spacerun:yes'>&nbsp; </span>{creation options}</p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>Additionally,
you can verify if all components from a certain writer will be included:<o:=
p></o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'><o:p>&nbsp;</o:p></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'>VSHADOW &#8211;wi=3DWrit=
erName <span
style=3D'mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style=3D'mso-spacerun:yes'>&nbsp;</span>{snapshot creation options}</p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'>VSHADOW &#8211;wi=3D&quo=
t;Writer
name&quot;<span style=3D'mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp; </span>
{snapshot creation options}</p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'>VSHADOW &#8211;wi=3D{Wri=
terID}<span
style=3D'mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>
{snapshot creation options}</p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'>VSHADOW &#8211;wi=3D{Ins=
tanceID} <span
style=3D'mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp; </span><span
style=3D'mso-spacerun:yes'>&nbsp;</span>{snapshot creation options}</p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>You
can specify a set of writers/components by specifying the &#8220;-wi&#8221;
flag several times in the same command line. For example: <o:p></o:p></span=
></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText style=3D'text-indent:.5in'>VSHADOW -wi=3D&quot;Regi=
stry
Writer:\Registry&quot; -wi=3D&#8221;COM+ REGDB Writer&#8221;</p>

<p class=3DMsoPlainText><o:p>&nbsp;</o:p></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>The
component string as accepted by VSHADOW can be viewed using the &#8220;VSHA=
DOW
&#8211;wm&quot; command. Here is an example: <o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText>C:\&gt; VSHADOW -wm</p>

<p class=3DMsoPlainText><o:p>&nbsp;</o:p></p>

<p class=3DMsoPlainText>VSHADOW.EXE 3.0 - Volume Shadow Copy sample client<=
/p>

<p class=3DMsoPlainText>Copyright (C) 2005 Microsoft Corporation. All rights
reserved.</p>

<p class=3DMsoPlainText><o:p>&nbsp;</o:p></p>

<p class=3DMsoPlainText><o:p>&nbsp;</o:p></p>

<p class=3DMsoPlainText>(Option: List writer metadata)</p>

<p class=3DMsoPlainText>(Gathering writer metadata...)</p>

<p class=3DMsoPlainText>Initialize writer metadata ...</p>

<p class=3DMsoPlainText>Listing writer metadata ...</p>

<p class=3DMsoPlainText><o:p>&nbsp;</o:p></p>

<p class=3DMsoPlainText>* WRITER 'MSDEWriter'</p>

<p class=3DMsoPlainText><span style=3D'mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;
</span>- WriterId<span style=3D'mso-spacerun:yes'>&nbsp;&nbsp; </span>=3D
{01b5efaa-1b5f0ba-6f73c-6f7306f790-6f7286f73c6f73c1bd483c6f73c6f73c}</p>

<p class=3DMsoPlainText><span style=3D'mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;
</span>- InstanceId =3D {0006f74c-6f730-6f73c-6f7286f74c-6f73c0100001050e8a=
4d}</p>

<p class=3DMsoPlainText><span style=3D'mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;
</span>- Excluded files:</p>

<p class=3DMsoPlainText><span style=3D'mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;
</span>- Component <span style=3D'color:red'>&quot;MSDEWriter:\AOLTEAN-DEV\=
SRMSERVICES\master&quot;</span></p>

<p class=3DMsoPlainText><span
style=3D'mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>- Na=
me: 'master'</p>

<p class=3DMsoPlainText><span
style=3D'mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>- Lo=
gical
Path: 'AOLTEAN-DEV\SRMSERVICES'</p>

<p class=3DMsoPlainText><span
style=3D'mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>- Fu=
ll
Path: '\AOLTEAN-DEV\SRMSERVICES\master'</p>

<p class=3DMsoPlainText><span
style=3D'mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>- Ca=
ption:
''</p>

<p class=3DMsoPlainText><span
style=3D'mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>- Ty=
pe:
VSS_CT_DATABASE [1]</p>

<p class=3DMsoPlainText><span
style=3D'mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>- Is
Selectable: 'TRUE'</p>

<p class=3DMsoPlainText><span
style=3D'mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>- Is=
 top
level: 'TRUE'</p>

<p class=3DMsoPlainText><span
style=3D'mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>- No=
tify
on backup complete: 'FALSE'</p>

<p class=3DMsoPlainText><span
style=3D'mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>- Af=
fected
paths by this component:</p>

<p class=3DMsoPlainText><span
style=3D'mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>- C:\Program Files\Microsoft <st1:mswterms w:st=3D"on">SQL Server</s=
t1:mswterms>\MSSQL$SRMSERVICES\Data</p>

<p class=3DMsoPlainText><span
style=3D'mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>- Af=
fected
volumes by this component:</p>

<p class=3DMsoPlainText><span
style=3D'mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>- \\?\Volume{4bcddd9a-9e9e-11d6-b7f4-806e6f6e6963}\ [C:\]</p>

<p class=3DMsoPlainText><o:p>&nbsp;</o:p></p>

<p class=3DMsoPlainText>C:\&gt; VSHADOW &#8211;wi=3D<span style=3D'color:re=
d'>&quot;MSDEWriter:\AOLTEAN-DEV\SRMSERVICES\master&quot;
</span>c:</p>

<p class=3DMsoPlainText><o:p>&nbsp;</o:p></p>

<p class=3DMsoPlainText><o:p>&nbsp;</o:p></p>

<h3><a name=3D"_Toc146699247">Writer/component exclusion</a></h3>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><span
style=3D'mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp; </span><o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>Additionally,
it is possible to explicitly exclude a certain list of writers\components
during snapshot creation or restore. For example you would like to avoid
certain writers that fail during snapshot creation. Or, you might want to
restore only certain components. <o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>This
option has a similar syntax with the &#8220;-wi&#8221; option. To exclude a
certain writer, use the &#8211;wx option:<o:p></o:p></span></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'><o:p>&nbsp;</o:p></p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'>VSHADOW &#8211;wx=3DWrit=
erName <span
style=3D'mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style=3D'mso-spacerun:yes'>&nbsp;</span>{snapshot creation options}</p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'>VSHADOW &#8211;wx=3D&quo=
t;Writer
name&quot;<span style=3D'mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp; </span>
{snapshot creation options}</p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'>VSHADOW &#8211;wx=3D{Wri=
terID}<span
style=3D'mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>
{snapshot creation options}</p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'>VSHADOW &#8211;wx=3D{Ins=
tanceID} <span
style=3D'mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp; </span><span
style=3D'mso-spacerun:yes'>&nbsp;</span>{snapshot creation options}</p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>Also,
you can exclude a certain component from a writer. You can use the same syn=
tax
as above except that you append a colon character to the writer name, follo=
wed
by the logical path and the component name. A backslash must be present bet=
ween
the logical path and the component name. <o:p></o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText style=3D'text-indent:.5in'>VSHADOW
&#8211;wx=3DWriterName:\LogicalPath\ComponentName<span style=3D'mso-tab-cou=
nt:1'>&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style=3D'mso-spacerun:yes'>&nbsp;&nbsp; </span>{creation options}</p>

<p class=3DMsoPlainText style=3D'text-indent:.5in'>VSHADOW &#8211;wx=3D&quo=
t;Writer
name:\LogicalPath\ComponentName&quot; {creation options}</p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'>VSHADOW
&#8211;wx=3D{WriterID}:\LogicalPath\ComponentName<span
style=3D'mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>{creation options}</p>

<p class=3DMsoPlainText style=3D'margin-left:.5in'>VSHADOW
&#8211;wx=3D{InstanceID}:\LogicalPath\ComponentName<span
style=3D'mso-spacerun:yes'>&nbsp; </span>{creation options}</p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'>You
can specify a set of writers/components by specifying the &#8220;-wx&#8221;
flag several times in the same command line. For example: <o:p></o:p></span=
></p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=3DMsoPlainText style=3D'text-indent:.5in'>VSHADOW -wx=3D&quot;Regi=
stry
Writer:\Registry&quot; -wx=3D&#8221;COM+ REGDB Writer&#8221;</p>

<p class=3DMsoPlainText><o:p>&nbsp;</o:p></p>

<h3><a name=3D"_Toc146699248">Component selection during shadow copy creati=
on</a></h3>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal>The sample code has a simple component selection algor=
ithm.
Based on the given set of volumes, it will safely select the maximal set of
components from all writers, such that no selected component (implicitly or
explicitly) will have its file descriptors on volumes not in the shadow set=
. In
other words if the component X will have file descriptors on volume Y: outs=
ide
the shadow copy set, then this component won&#8217;t be selected. </p>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal><b style=3D'mso-bidi-font-weight:normal'>Definitions:<=
o:p></o:p></b></p>

<p class=3DMsoNormal style=3D'margin-left:.5in;text-indent:-.25in;mso-list:=
l7 level1 lfo4;
tab-stops:list .5in'><![if !supportLists]><span style=3D'mso-fareast-font-f=
amily:
Arial;mso-bidi-font-family:Arial'><span style=3D'mso-list:Ignore'>-<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>X is ancestor of Y =3D Y is descendent of X =
=3D
including component X implies including component Y.</p>

<p class=3DMsoNormal style=3D'margin-left:.5in;text-indent:-.25in;mso-list:=
l7 level1 lfo4;
tab-stops:list .5in'><![if !supportLists]><span style=3D'mso-fareast-font-f=
amily:
Arial;mso-bidi-font-family:Arial'><span style=3D'mso-list:Ignore'>-<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>Directly excluded component =3D component th=
at
cannot be included since one of its file groups has data outside the shadow
copy set.</p>

<p class=3DMsoNormal style=3D'margin-left:.5in;text-indent:-.25in;mso-list:=
l7 level1 lfo4;
tab-stops:list .5in'><![if !supportLists]><span style=3D'mso-fareast-font-f=
amily:
Arial;mso-bidi-font-family:Arial'><span style=3D'mso-list:Ignore'>-<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>Excluded component =3D component that cannot=
 be
included since one of its descendents is directly excluded.</p>

<p class=3DMsoNormal style=3D'margin-left:.5in;text-indent:-.25in;mso-list:=
l7 level1 lfo4;
tab-stops:list .5in'><![if !supportLists]><span style=3D'mso-fareast-font-f=
amily:
Arial;mso-bidi-font-family:Arial'><span style=3D'mso-list:Ignore'>-<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>Non-excluded component =3D component that is=
 not
excluded. Note that this component is not necessarily included. </p>

<p class=3DMsoNormal style=3D'margin-left:.5in;text-indent:-.25in;mso-list:=
l7 level1 lfo4;
tab-stops:list .5in'><![if !supportLists]><span style=3D'mso-fareast-font-f=
amily:
Arial;mso-bidi-font-family:Arial'><span style=3D'mso-list:Ignore'>-<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>Included component =3D All components that a=
re
non-excluded and are equal or descendants of:</p>

<p class=3DMsoNormal style=3D'margin-left:1.0in;text-indent:-.25in;mso-list=
:l7 level2 lfo4;
tab-stops:list 1.0in'><![if !supportLists]><span style=3D'font-family:"Cour=
ier New";
mso-fareast-font-family:"Courier New"'><span style=3D'mso-list:Ignore'>o<sp=
an
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;
</span></span></span><![endif]>Either a selectable non-excluded component.<=
/p>

<p class=3DMsoNormal style=3D'margin-left:1.0in;text-indent:-.25in;mso-list=
:l7 level2 lfo4;
tab-stops:list 1.0in'><![if !supportLists]><span style=3D'font-family:"Cour=
ier New";
mso-fareast-font-family:"Courier New"'><span style=3D'mso-list:Ignore'>o<sp=
an
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;
</span></span></span><![endif]>Or a non-selectable non-excluded top-level
component.</p>

<p class=3DMsoNormal style=3D'margin-left:.5in;text-indent:-.25in;mso-list:=
l7 level1 lfo4;
tab-stops:list .5in'><![if !supportLists]><span style=3D'mso-fareast-font-f=
amily:
Arial;mso-bidi-font-family:Arial'><span style=3D'mso-list:Ignore'>-<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>Explicitly included component =3D non-exclud=
ed
component on which IVssBackupComponents::AddComponent will be called. This
component should be either:</p>

<p class=3DMsoNormal style=3D'margin-left:1.0in;text-indent:-.25in;mso-list=
:l7 level2 lfo4;
tab-stops:list 1.0in'><![if !supportLists]><span style=3D'font-family:"Cour=
ier New";
mso-fareast-font-family:"Courier New"'><span style=3D'mso-list:Ignore'>o<sp=
an
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;
</span></span></span><![endif]>A selectable, non-excluded component with no
explicitly included ancestors.</p>

<p class=3DMsoNormal style=3D'margin-left:1.0in;text-indent:-.25in;mso-list=
:l7 level2 lfo4;
tab-stops:list 1.0in'><![if !supportLists]><span style=3D'font-family:"Cour=
ier New";
mso-fareast-font-family:"Courier New"'><span style=3D'mso-list:Ignore'>o<sp=
an
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;
</span></span></span><![endif]>Or a top-level non-selectable non-excluded
component.</p>

<p class=3DMsoNormal style=3D'margin-left:.5in;text-indent:-.25in;mso-list:=
l7 level1 lfo4;
tab-stops:list .5in'><![if !supportLists]><span style=3D'mso-fareast-font-f=
amily:
Arial;mso-bidi-font-family:Arial'><span style=3D'mso-list:Ignore'>-<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>Implicitly included component =3D descendent=
 of an
explicitly included component. </p>

<p class=3DMsoNormal style=3D'margin-left:.5in;text-indent:-.25in;mso-list:=
l7 level1 lfo4;
tab-stops:list .5in'><![if !supportLists]><span style=3D'mso-fareast-font-f=
amily:
Arial;mso-bidi-font-family:Arial'><span style=3D'mso-list:Ignore'>-<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>X is root in list L =3D X does not have ance=
stors
in list L.</p>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal><b style=3D'mso-bidi-font-weight:normal'>General VSS s=
election
rules:<o:p></o:p></b></p>

<p class=3DMsoNormal style=3D'margin-left:.5in;text-indent:-.25in;mso-list:=
l7 level1 lfo4;
tab-stops:list .5in'><![if !supportLists]><span style=3D'mso-fareast-font-f=
amily:
Arial;mso-bidi-font-family:Arial'><span style=3D'mso-list:Ignore'>-<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>You can call AddComponent only on selectable=
 components
and/or on top-level non-selectable components. </p>

<p class=3DMsoNormal style=3D'margin-left:.5in;text-indent:-.25in;mso-list:=
l7 level1 lfo4;
tab-stops:list .5in'><![if !supportLists]><span style=3D'mso-fareast-font-f=
amily:
Arial;mso-bidi-font-family:Arial'><span style=3D'mso-list:Ignore'>-<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>If you explicitly include a component (i.e. =
call
AddComponent on it), then all descendents are implicitly included. You are =
not
allowed to call AddComponent on one of its descendents. </p>

<p class=3DMsoNormal style=3D'margin-left:.5in;text-indent:-.25in;mso-list:=
l7 level1 lfo4;
tab-stops:list .5in'><![if !supportLists]><span style=3D'mso-fareast-font-f=
amily:
Arial;mso-bidi-font-family:Arial'><span style=3D'mso-list:Ignore'>-<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>If at least one component is included from a
writer X then <b style=3D'mso-bidi-font-weight:normal'>all</b> top-level
non-selectable components from this writer must be explicitly included as w=
ell.
</p>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal><b style=3D'mso-bidi-font-weight:normal'>The component
selection verification algorithm used by VSHADOW:<o:p></o:p></b></p>

<p class=3DMsoNormal style=3D'margin-left:.5in;text-indent:-.25in;mso-list:=
l7 level1 lfo4;
tab-stops:list .5in'><![if !supportLists]><span style=3D'mso-fareast-font-f=
amily:
Arial;mso-bidi-font-family:Arial'><span style=3D'mso-list:Ignore'>-<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>First we discover all directly excluded
components. These are components that have file groups containing data outs=
ide
the volumes that have to be shadow copied.</p>

<p class=3DMsoNormal style=3D'margin-left:.5in;text-indent:-.25in;mso-list:=
l7 level1 lfo4;
tab-stops:list .5in'><![if !supportLists]><span style=3D'mso-fareast-font-f=
amily:
Arial;mso-bidi-font-family:Arial'><span style=3D'mso-list:Ignore'>-<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>Then we discover all excluded components. Th=
ese
are all components that have at least one directly excluded descendent. </p>

<p class=3DMsoNormal style=3D'margin-left:.5in;text-indent:-.25in;mso-list:=
l7 level1 lfo4;
tab-stops:list .5in'><![if !supportLists]><span style=3D'mso-fareast-font-f=
amily:
Arial;mso-bidi-font-family:Arial'><span style=3D'mso-list:Ignore'>-<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>Then we discover if the writer needs to be
excluded. The writer will be excluded if:</p>

<p class=3DMsoNormal style=3D'margin-left:1.0in;text-indent:-.25in;mso-list=
:l7 level2 lfo4;
tab-stops:list 1.0in'><![if !supportLists]><span style=3D'font-family:"Cour=
ier New";
mso-fareast-font-family:"Courier New"'><span style=3D'mso-list:Ignore'>o<sp=
an
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;
</span></span></span><![endif]>Either all its selectable components are
excluded</p>

<p class=3DMsoNormal style=3D'margin-left:1.0in;text-indent:-.25in;mso-list=
:l7 level2 lfo4;
tab-stops:list 1.0in'><![if !supportLists]><span style=3D'font-family:"Cour=
ier New";
mso-fareast-font-family:"Courier New"'><span style=3D'mso-list:Ignore'>o<sp=
an
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;
</span></span></span><![endif]>Or the writer contains at least one excluded
top-level non-selectable component </p>

<p class=3DMsoNormal style=3D'margin-left:.5in;text-indent:-.25in;mso-list:=
l7 level1 lfo4;
tab-stops:list .5in'><![if !supportLists]><span style=3D'mso-fareast-font-f=
amily:
Arial;mso-bidi-font-family:Arial'><span style=3D'mso-list:Ignore'>-<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>We establish now the list of explicitly incl=
uded
components:</p>

<p class=3DMsoNormal style=3D'margin-left:1.0in;text-indent:-.25in;mso-list=
:l7 level2 lfo4;
tab-stops:list 1.0in'><![if !supportLists]><span style=3D'font-family:"Cour=
ier New";
mso-fareast-font-family:"Courier New"'><span style=3D'mso-list:Ignore'>o<sp=
an
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;
</span></span></span><![endif]>First, we isolate the subset of components t=
hat
are candidate for explicit inclusion</p>

<p class=3DMsoNormal style=3D'margin-left:1.5in;text-indent:-.25in;mso-list=
:l7 level3 lfo4;
tab-stops:list 1.5in'><![if !supportLists]><span style=3D'font-family:Wingd=
ings;
mso-fareast-font-family:Wingdings;mso-bidi-font-family:Wingdings'><span
style=3D'mso-list:Ignore'>&sect;<span style=3D'font:7.0pt "Times New Roman"=
'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>Either selectable non-excluded components </=
p>

<p class=3DMsoNormal style=3D'margin-left:1.5in;text-indent:-.25in;mso-list=
:l7 level3 lfo4;
tab-stops:list 1.5in'><![if !supportLists]><span style=3D'font-family:Wingd=
ings;
mso-fareast-font-family:Wingdings;mso-bidi-font-family:Wingdings'><span
style=3D'mso-list:Ignore'>&sect;<span style=3D'font:7.0pt "Times New Roman"=
'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>Or non-selectable top-level non-excluded
components</p>

<p class=3DMsoNormal style=3D'margin-left:1.0in;text-indent:-.25in;mso-list=
:l7 level2 lfo4;
tab-stops:list 1.0in'><![if !supportLists]><span style=3D'font-family:"Cour=
ier New";
mso-fareast-font-family:"Courier New"'><span style=3D'mso-list:Ignore'>o<sp=
an
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;
</span></span></span><![endif]>From the list above we retain the roots, i.e.
components that </p>

<p class=3DMsoNormal style=3D'margin-left:1.5in;text-indent:-.25in;mso-list=
:l7 level3 lfo4;
tab-stops:list 1.5in'><![if !supportLists]><span style=3D'font-family:Wingd=
ings;
mso-fareast-font-family:Wingdings;mso-bidi-font-family:Wingdings'><span
style=3D'mso-list:Ignore'>&sect;<span style=3D'font:7.0pt "Times New Roman"=
'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>Are candidate for explicit exclusion </p>

<p class=3DMsoNormal style=3D'margin-left:1.5in;text-indent:-.25in;mso-list=
:l7 level3 lfo4;
tab-stops:list 1.5in'><![if !supportLists]><span style=3D'font-family:Wingd=
ings;
mso-fareast-font-family:Wingdings;mso-bidi-font-family:Wingdings'><span
style=3D'mso-list:Ignore'>&sect;<span style=3D'font:7.0pt "Times New Roman"=
'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>Have no ancestors that are candidate for
explicit exclusion</p>

<p class=3DMsoNormal style=3D'margin-left:.5in;text-indent:-.25in;mso-list:=
l7 level1 lfo4;
tab-stops:list .5in'><![if !supportLists]><span style=3D'mso-fareast-font-f=
amily:
Arial;mso-bidi-font-family:Arial'><span style=3D'mso-list:Ignore'>-<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>Finally, we select all the explicitly includ=
ed
components using AddComponent.</p>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal><b style=3D'mso-bidi-font-weight:normal'>Limitations o=
f this
algorithm:<o:p></o:p></b></p>

<p class=3DMsoNormal style=3D'margin-left:.5in;text-indent:-.25in;mso-list:=
l7 level1 lfo4;
tab-stops:list .5in'><![if !supportLists]><span style=3D'mso-fareast-font-f=
amily:
Arial;mso-bidi-font-family:Arial'><span style=3D'mso-list:Ignore'>-<span
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>The component consistency verification algor=
ithm
in VSHADOW has two limitations. </p>

<p class=3DMsoNormal style=3D'margin-left:1.0in;text-indent:-.25in;mso-list=
:l7 level2 lfo4;
tab-stops:list 1.0in'><![if !supportLists]><span style=3D'font-family:"Cour=
ier New";
mso-fareast-font-family:"Courier New"'><span style=3D'mso-list:Ignore'>o<sp=
an
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;
</span></span></span><![endif]>The algorithm will not follow component
dependencies. In other words, if component X from writer A depends on compo=
nent
Y from writer B, and the component Y will be excluded, then this does not
necessarily means that the component X will be excluded as well. However, t=
he
writer A might fail since its dependent component Y was not selected during=
 the
backup. </p>

<p class=3DMsoNormal style=3D'margin-left:1.0in;text-indent:-.25in;mso-list=
:l7 level2 lfo4;
tab-stops:list 1.0in'><![if !supportLists]><span style=3D'font-family:"Cour=
ier New";
mso-fareast-font-family:"Courier New"'><span style=3D'mso-list:Ignore'>o<sp=
an
style=3D'font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;
</span></span></span><![endif]>The algorithm will not follow mount point
chains. In other words, if component X defines a File Descriptor including =
all
recursive files under a certain directory c:\foo, then VSHADOW will not ver=
ify
if all mount points recursively mounted under C:\ are included in the shadow
copy set. Therefore the component will still be added to the backup even if
certain parts of the reported namespace are not shadow copied.<span
style=3D'mso-bidi-font-family:Arial'><o:p></o:p></span></p>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<h3><a name=3D"_Toc146699249">Component selection for restore</a></h3>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal>In the case of restore, the component selection is don=
e only
on the components already present (backed-up) in the backup components
document. By default, all components from the backup components document are
considered for restore, unless &#8220;-wx&#8221; is used.</p>

<p class=3DMsoNormal><span style=3D'mso-bidi-font-family:Arial'><o:p>&nbsp;=
</o:p></span></p>

<p class=3DMsoNormal>A backed-up component can be restored through VSHADOW =
only
if the associated writer is already running on the machine. The existing
components on the currently-running writers are ignored. <span
style=3D'mso-bidi-font-family:Arial'><o:p></o:p></span></p>

<p class=3DMsoNormal><span style=3D'mso-bidi-font-family:Arial'><o:p>&nbsp;=
</o:p></span></p>

<p class=3DMsoNormal>The exclusion/inclusion rules mentioned above for the =
shadow
creation case apply in a similar manner during restore. A previously backed=
-up
component can be specifically excluded with the &#8220;-wx&#8221; option. A=
lso,
you can verify the selectability state of a certain component during restore
through the &#8220;-wi&#8221; option. <span style=3D'mso-bidi-font-family:A=
rial'><o:p></o:p></span></p>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal><b style=3D'mso-bidi-font-weight:normal'>Limitations o=
f this
algorithm: <o:p></o:p></b></p>

<p class=3DMsoNormal><o:p>&nbsp;</o:p></p>

<p class=3DMsoNormal>The current VSHADOW code has only minimal restore supp=
ort.
The code does not offer any way to do partial restores, new targets, altern=
ate
targets, subcomponent selection or other advanced restore functionality that
can be found in a true requestor. </p>

<p class=3DMsoPlainText><span style=3D'font-family:Arial'><o:p>&nbsp;</o:p>=
</span></p>

<h2><a name=3D"_Toc146699250">List of files in the VSHADOW project</a></h2>

<p class=3DMsoPlainText><span style=3D'font-family:Arial'><o:p>&nbsp;</o:p>=
</span></p>

<table class=3DMsoTableGrid border=3D1 cellspacing=3D0 cellpadding=3D0
 style=3D'border-collapse:collapse;border:none;mso-border-alt:solid windowt=
ext .5pt;
 mso-yfti-tbllook:480;mso-padding-alt:0in 5.4pt 0in 5.4pt;mso-border-inside=
h:
 .5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style=3D'mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=3D116 valign=3Dtop style=3D'width:86.65pt;border:solid windowte=
xt 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=3DMsoPlainText><b style=3D'mso-bidi-font-weight:normal'><span
  style=3D'font-family:Arial'>File name<o:p></o:p></span></b></p>
  </td>
  <td width=3D384 valign=3Dtop style=3D'width:288.35pt;border:solid windowt=
ext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=3DMsoPlainText><b style=3D'mso-bidi-font-weight:normal'><span
  style=3D'font-family:Arial'>Description<o:p></o:p></span></b></p>
  </td>
 </tr>
 <tr style=3D'mso-yfti-irow:1'>
  <td width=3D116 valign=3Dtop style=3D'width:86.65pt;border:solid windowte=
xt 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:s=
olid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=3DMsoPlainText><span style=3D'font-family:Arial'>macros.h<o:p></=
o:p></span></p>
  </td>
  <td width=3D384 valign=3Dtop style=3D'width:288.35pt;border-top:none;bord=
er-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1=
.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid window=
text .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=3DMsoPlainText><span style=3D'font-family:Arial'>Useful macros<o=
:p></o:p></span></p>
  </td>
 </tr>
 <tr style=3D'mso-yfti-irow:2'>
  <td width=3D116 valign=3Dtop style=3D'width:86.65pt;border:solid windowte=
xt 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:s=
olid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=3DMsoPlainText><span style=3D'font-family:Arial'>create.cpp<o:p>=
</o:p></span></p>
  </td>
  <td width=3D384 valign=3Dtop style=3D'width:288.35pt;border-top:none;bord=
er-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1=
.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid window=
text .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=3DMsoPlainText><span style=3D'font-family:Arial'>VSS shadow copy
  creation code<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style=3D'mso-yfti-irow:3'>
  <td width=3D116 valign=3Dtop style=3D'width:86.65pt;border:solid windowte=
xt 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:s=
olid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=3DMsoPlainText><span style=3D'font-family:Arial'>delete.cpp<o:p>=
</o:p></span></p>
  </td>
  <td width=3D384 valign=3Dtop style=3D'width:288.35pt;border-top:none;bord=
er-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1=
.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid window=
text .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=3DMsoPlainText><span style=3D'font-family:Arial'>VSS shadow copy
  deletion code<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style=3D'mso-yfti-irow:4'>
  <td width=3D116 valign=3Dtop style=3D'width:86.65pt;border:solid windowte=
xt 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:s=
olid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=3DMsoPlainText><span style=3D'font-family:Arial'>break.cpp<o:p><=
/o:p></span></p>
  </td>
  <td width=3D384 valign=3Dtop style=3D'width:288.35pt;border-top:none;bord=
er-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1=
.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid window=
text .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=3DMsoPlainText><span style=3D'font-family:Arial'>VSS shadow copy=
 break
  code<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style=3D'mso-yfti-irow:5'>
  <td width=3D116 valign=3Dtop style=3D'width:86.65pt;border:solid windowte=
xt 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:s=
olid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=3DMsoPlainText><span style=3D'font-family:Arial'>query.cpp<o:p><=
/o:p></span></p>
  </td>
  <td width=3D384 valign=3Dtop style=3D'width:288.35pt;border-top:none;bord=
er-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1=
.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid window=
text .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=3DMsoPlainText><span style=3D'font-family:Arial'>VSS shadow copy=
 query
  code<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style=3D'mso-yfti-irow:6'>
  <td width=3D116 valign=3Dtop style=3D'width:86.65pt;border:solid windowte=
xt 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:s=
olid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=3DMsoPlainText><span style=3D'font-family:Arial'>stdafx.cpp<o:p>=
</o:p></span></p>
  </td>
  <td width=3D384 rowspan=3D2 valign=3Dtop style=3D'width:288.35pt;border-t=
op:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid =
windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid window=
text .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=3DMsoPlainText><span style=3D'font-family:Arial'>Precompiled hea=
der
  (general declarations)<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style=3D'mso-yfti-irow:7'>
  <td width=3D116 valign=3Dtop style=3D'width:86.65pt;border:solid windowte=
xt 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:s=
olid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=3DMsoPlainText><span style=3D'font-family:Arial'>stdafx.h<o:p></=
o:p></span></p>
  </td>
 </tr>
 <tr style=3D'mso-yfti-irow:8'>
  <td width=3D116 valign=3Dtop style=3D'width:86.65pt;border:solid windowte=
xt 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:s=
olid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=3DMsoPlainText><span style=3D'font-family:Arial'>tracing.cpp<o:p=
></o:p></span></p>
  </td>
  <td width=3D384 rowspan=3D2 valign=3Dtop style=3D'width:288.35pt;border-t=
op:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid =
windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid window=
text .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=3DMsoPlainText><span style=3D'font-family:Arial'>Very simple
  tracing/logging class<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style=3D'mso-yfti-irow:9'>
  <td width=3D116 valign=3Dtop style=3D'width:86.65pt;border:solid windowte=
xt 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:s=
olid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=3DMsoPlainText><span style=3D'font-family:Arial'>tracing.h<o:p><=
/o:p></span></p>
  </td>
 </tr>
 <tr style=3D'mso-yfti-irow:10'>
  <td width=3D116 valign=3Dtop style=3D'width:86.65pt;border:solid windowte=
xt 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:s=
olid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=3DMsoPlainText><span style=3D'font-family:Arial'>util.h<o:p></o:=
p></span></p>
  </td>
  <td width=3D384 valign=3Dtop style=3D'width:288.35pt;border-top:none;bord=
er-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1=
.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid window=
text .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=3DMsoPlainText><span style=3D'font-family:Arial'>Utility routines
  (string conversion, volume APIs, etc)<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style=3D'mso-yfti-irow:11'>
  <td width=3D116 valign=3Dtop style=3D'width:86.65pt;border:solid windowte=
xt 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:s=
olid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=3DMsoPlainText><span style=3D'font-family:Arial'>shadow.cpp<o:p>=
</o:p></span></p>
  </td>
  <td width=3D384 rowspan=3D2 valign=3Dtop style=3D'width:288.35pt;border-t=
op:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid =
windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid window=
text .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=3DMsoPlainText><span style=3D'font-family:Arial'>VSHADOW command=
-line
  specific code (CLI parsing, usage routine, etc)<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style=3D'mso-yfti-irow:12'>
  <td width=3D116 valign=3Dtop style=3D'width:86.65pt;border:solid windowte=
xt 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:s=
olid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=3DMsoPlainText><span style=3D'font-family:Arial'>shadow.h<o:p></=
o:p></span></p>
  </td>
 </tr>
 <tr style=3D'mso-yfti-irow:13'>
  <td width=3D116 valign=3Dtop style=3D'width:86.65pt;border:solid windowte=
xt 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:s=
olid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=3DMsoPlainText><span style=3D'font-family:Arial'>vssclient.cpp<o=
:p></o:p></span></p>
  </td>
  <td width=3D384 rowspan=3D2 valign=3Dtop style=3D'width:288.35pt;border-t=
op:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid =
windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid window=
text .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=3DMsoPlainText><span style=3D'font-family:Arial'>Declaration/def=
inition
  of the VSS API wrapper class. <o:p></o:p></span></p>
  </td>
 </tr>
 <tr style=3D'mso-yfti-irow:14'>
  <td width=3D116 valign=3Dtop style=3D'width:86.65pt;border:solid windowte=
xt 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:s=
olid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=3DMsoPlainText><span style=3D'font-family:Arial'>vssclient.h<o:p=
></o:p></span></p>
  </td>
 </tr>
 <tr style=3D'mso-yfti-irow:15'>
  <td width=3D116 valign=3Dtop style=3D'width:86.65pt;border:solid windowte=
xt 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:s=
olid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=3DMsoPlainText><span style=3D'font-family:Arial'>Writer.h<o:p></=
o:p></span></p>
  </td>
  <td width=3D384 valign=3Dtop style=3D'width:288.35pt;border-top:none;bord=
er-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1=
.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid window=
text .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=3DMsoPlainText><span style=3D'font-family:Arial'>VSS writer meta=
data
  wrappers (writer, component, file descriptor, etc)<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style=3D'mso-yfti-irow:16'>
  <td width=3D116 valign=3Dtop style=3D'width:86.65pt;border:solid windowte=
xt 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:s=
olid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=3DMsoPlainText><span style=3D'font-family:Arial'>Select.cpp<o:p>=
</o:p></span></p>
  </td>
  <td width=3D384 valign=3Dtop style=3D'width:288.35pt;border-top:none;bord=
er-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1=
.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid window=
text .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=3DMsoPlainText><span style=3D'font-family:Arial'>Component selec=
tion
  code.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style=3D'mso-yfti-irow:17'>
  <td width=3D116 valign=3Dtop style=3D'width:86.65pt;border:solid windowte=
xt 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:s=
olid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=3DMsoPlainText><span style=3D'font-family:Arial'>writer.cpp<o:p>=
</o:p></span></p>
  </td>
  <td width=3D384 valign=3Dtop style=3D'width:288.35pt;border-top:none;bord=
er-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1=
.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid window=
text .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=3DMsoPlainText><span style=3D'font-family:Arial'>Implementation =
of VSS
  writer metadata wrappers <o:p></o:p></span></p>
  </td>
 </tr>
 <tr style=3D'mso-yfti-irow:18'>
  <td width=3D116 valign=3Dtop style=3D'width:86.65pt;border:solid windowte=
xt 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:s=
olid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=3DMsoPlainText><span style=3D'font-family:Arial'>vshadow.vcproj<=
o:p></o:p></span></p>
  </td>
  <td width=3D384 valign=3Dtop style=3D'width:288.35pt;border-top:none;bord=
er-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1=
.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid window=
text .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=3DMsoPlainText><span style=3D'font-family:Arial'>Visual Studio p=
roject
  file<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style=3D'mso-yfti-irow:19'>
  <td width=3D116 valign=3Dtop style=3D'width:86.65pt;border:solid windowte=
xt 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:s=
olid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=3DMsoPlainText><span style=3D'font-family:Arial'>readme <o:p></o=
:p></span></p>
  </td>
  <td width=3D384 valign=3Dtop style=3D'width:288.35pt;border-top:none;bord=
er-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1=
.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid window=
text .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=3DMsoPlainText><span style=3D'font-family:Arial'>This document<o=
:p></o:p></span></p>
  </td>
 </tr>
 <tr style=3D'mso-yfti-irow:20;mso-yfti-lastrow:yes'>
  <td width=3D116 valign=3Dtop style=3D'width:86.65pt;border:solid windowte=
xt 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:s=
olid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=3DMsoPlainText><span style=3D'font-family:Arial'>VShadow.sln<o:p=
></o:p></span></p>
  </td>
  <td width=3D384 valign=3Dtop style=3D'width:288.35pt;border-top:none;bord=
er-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1=
.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid window=
text .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=3DMsoPlainText><span style=3D'font-family:Arial'>Visual Studio s=
olution
  for VSHADOW<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=3DMsoNormal><span style=3D'mso-bidi-font-family:Arial'><o:p>&nbsp;=
</o:p></span></p>

</div>

</body>

</html>

------=_NextPart_01C6E0A9.E7E02880
Content-Location: file:///C:/EA821E05/Readme_files/header.htm
Content-Transfer-Encoding: quoted-printable
Content-Type: text/html; charset="us-ascii"

<html xmlns:v=3D"urn:schemas-microsoft-com:vml"
xmlns:o=3D"urn:schemas-microsoft-com:office:office"
xmlns:w=3D"urn:schemas-microsoft-com:office:word"
xmlns:st1=3D"urn:schemas-microsoft-com:office:smarttags"
xmlns=3D"http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=3DContent-Type content=3D"text/html; charset=3Dus-ascii">
<meta name=3DProgId content=3DWord.Document>
<meta name=3DGenerator content=3D"Microsoft Word 11">
<meta name=3DOriginator content=3D"Microsoft Word 11">
<link id=3DMain-File rel=3DMain-File href=3D"../Readme.htm">
<![if IE]>
<base href=3D"file:///C:\EA821E05\Readme_files\header.htm"
id=3D"webarch_temp_base_tag">
<![endif]><o:SmartTagType
 namespaceuri=3D"urn:schemas-microsoft-com:office:smarttags" name=3D"mswter=
ms"/>
</head>

<body lang=3DEN-US link=3Dblue vlink=3Dpurple>

<div style=3D'mso-element:footnote-separator' id=3Dfs>

<p class=3DMsoNormal><span style=3D'mso-special-character:footnote-separato=
r'><![if !supportFootnotes]>

<hr align=3Dleft size=3D1 width=3D"33%">

<![endif]></span></p>

</div>

<div style=3D'mso-element:footnote-continuation-separator' id=3Dfcs>

<p class=3DMsoNormal><span style=3D'mso-special-character:footnote-continua=
tion-separator'><![if !supportFootnotes]>

<hr align=3Dleft size=3D1>

<![endif]></span></p>

</div>

<div style=3D'mso-element:endnote-separator' id=3Des>

<p class=3DMsoNormal><span style=3D'mso-special-character:footnote-separato=
r'><![if !supportFootnotes]>

<hr align=3Dleft size=3D1 width=3D"33%">

<![endif]></span></p>

</div>

<div style=3D'mso-element:endnote-continuation-separator' id=3Decs>

<p class=3DMsoNormal><span style=3D'mso-special-character:footnote-continua=
tion-separator'><![if !supportFootnotes]>

<hr align=3Dleft size=3D1>

<![endif]></span></p>

</div>

<div style=3D'mso-element:header' id=3Dh1>

<p class=3DMsoPlainText><span style=3D'font-family:Arial'>The VSHADOW sampl=
e client<span
style=3D'mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style=3D'mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp; </span>Copyright
&copy; 2006, Microsoft Corporation. <o:p></o:p></span></p>

</div>

<div style=3D'mso-element:footer' id=3Def1>

<div style=3D'mso-element:frame;mso-element-wrap:around;mso-element-anchor-=
vertical:
paragraph;mso-element-anchor-horizontal:margin;mso-element-left:right;
mso-element-top:.05pt;mso-height-rule:exactly'>

<table cellspacing=3D0 cellpadding=3D0 hspace=3D0 vspace=3D0 align=3Dright>
 <tr>
  <td valign=3Dtop align=3Dleft style=3D'padding-top:0in;padding-right:0in;
  padding-bottom:0in;padding-left:0in'>
  <p class=3DMsoFooter style=3D'mso-element:frame;mso-element-wrap:around;
  mso-element-anchor-vertical:paragraph;mso-element-anchor-horizontal:margi=
n;
  mso-element-left:right;mso-element-top:.05pt;mso-height-rule:exactly'><!-=
-[if supportFields]><span
  class=3DMsoPageNumber><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Times New Roman"'><span
  style=3D'mso-element:field-begin'></span>PAGE<span
  style=3D'mso-spacerun:yes'>&nbsp; </span></span></span><![endif]--><!--[i=
f supportFields]><span
  class=3DMsoPageNumber><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Times New Roman"'><span
  style=3D'mso-element:field-end'></span></span></span><![endif]--><span
  class=3DMsoPageNumber><span style=3D'font-family:Arial;mso-bidi-font-fami=
ly:"Times New Roman"'><o:p></o:p></span></span></p>
  </td>
 </tr>
</table>

</div>

<p class=3DMsoFooter style=3D'margin-right:.25in'><o:p>&nbsp;</o:p></p>

</div>

<div style=3D'mso-element:footer' id=3Df1>

<p class=3DMsoFooter style=3D'margin-right:.25in'>Page <span style=3D'mso-f=
ield-code:
" PAGE "'><span style=3D'mso-no-proof:yes'>1</span></span> of <span
style=3D'mso-field-code:" NUMPAGES "'><span style=3D'mso-no-proof:yes'>12</=
span></span></p>

</div>

</body>

</html>

------=_NextPart_01C6E0A9.E7E02880
Content-Location: file:///C:/EA821E05/Readme_files/filelist.xml
Content-Transfer-Encoding: quoted-printable
Content-Type: text/xml; charset="utf-8"

<xml xmlns:o=3D"urn:schemas-microsoft-com:office:office">
 <o:MainFile HRef=3D"../Readme.htm"/>
 <o:File HRef=3D"header.htm"/>
 <o:File HRef=3D"filelist.xml"/>
</xml>
------=_NextPart_01C6E0A9.E7E02880--
